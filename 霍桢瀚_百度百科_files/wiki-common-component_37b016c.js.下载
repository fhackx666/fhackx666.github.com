;/*!wiki-common:widget/component/nslog/nslog.js*/
define("wiki-common:widget/component/nslog/nslog",function(t,o,n){"use strict";var u=t("wiki-common:widget/lib/jquery/jquery");function i(t){var o;t&&((o=t[0]).type?(this.init(o),this.log()):this.sendLog(o,t[1],t[2]))}i._globalDetail={},i.prototype={constructor:i,options:{},init:function(t){var o={type:void 0,url:encodeURIComponent(window.location.href),pid:103,referrer:encodeURIComponent(window.location.href)||void 0};this.options=u.extend(!0,{},o,t)},set:function(t,o){this.options[t]=o},req:function(t){var o="iknowlog_"+(new Date).getTime(),n=window[o]=new Image;n.onload=n.onerror=function(){window[o]=null},n.src=t},log:function(){var t,o=this,n=(new Date).getTime(),e="https:"===window.location.protocol?["https://nsclick.baidu.com/v.gif?t="+n]:["http://nsclick.baidu.com/v.gif?t="+n];for(t in o.options)"url"!==t&&e.push(t+"="+o.options[t]);e.push("url="+o.options.url),o.req(e.join("&"))},autoListen:function(){var r=this,t=u(window);/ipad/i.test(navigator.userAgent)?document.addEventListener("touchstart",function(t){try{var o=function t(o){var n;1===o.changedTouches.length&&(n=o.changedTouches[0].pageX,o=o.changedTouches[0].pageY,Math.abs(n-i)<5&&Math.abs(o-a)<5&&r.loop(e),e.removeEventListener("touchend",t))};if(1!==t.touches.length)return;var e=t.touches[0].target,i=t.touches[0].pageX,a=t.touches[0].pageY;e.addEventListener("touchend",o)}catch(t){}}):t.on("mousedown",function(t){try{var o=t.target;r.loop(o)}catch(t){}})},loop:function(t){for(var o,n,e,i,a=3,r=!0,s=!1,c="";t;)1==t.nodeType&&(e=(i=u(t)).attr("nslog")||"normal",o=t.href||window.location.href,n=i.attr("nslog-type"),i=(i=i.attr("nslog-params"))&&u.parseJSON(i),0<a&&(n&&r&&"normal"===e&&(this.sendLog(n,o,i),r=!1),!s&&(t.href||/input/i.test(t.tagName)&&/button|radio|checkbox|submit/i.test(t.type)||/img/i.test(t.tagName))&&(s=!0,c=o)),s&&"area"===e&&this.sendLog(n,c,i)),a--,t=t.parentNode},sendLog:function(t,o,n){var e=this;t&&(e.init(),o&&"javascript:;"!==o&&(e.options.url=o),e.options.type=t,e.options=u.extend(!0,{},e.options,n,i._globalDetail),e.log())},setGlobal:function(t){i._globalDetail=t}},(new i).autoListen(),n.exports=function(){return 0<arguments.length?new i(arguments):new i}});
;/*!wiki-common:widget/component/share/dep/qrcode.js*/
define("wiki-common:widget/component/share/dep/qrcode",function(t,e,r){var y;!function(){function e(t){this.mode=n.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;e<r;e++){var o=[],i=this.data.charCodeAt(e);65536<i?(o[0]=240|(1835008&i)>>>18,o[1]=128|(258048&i)>>>12,o[2]=128|(4032&i)>>>6,o[3]=128|63&i):2048<i?(o[0]=224|(61440&i)>>>12,o[1]=128|(4032&i)>>>6,o[2]=128|63&i):128<i?(o[0]=192|(1984&i)>>>6,o[1]=128|63&i):o[0]=i,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function h(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function m(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function u(t,e){this.totalCount=t,this.dataCount=e}function l(){this.buffer=[],this.length=0}e.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)}},h.prototype={addData:function(t){t=new e(t);this.dataList.push(t),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[r][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=h.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(var o=-1;o<=7;o++)e+o<=-1||this.moduleCount<=e+o||(this.modules[t+r][e+o]=0<=r&&r<=6&&(0==o||6==o)||0<=o&&o<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=o&&o<=4)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;r<8;r++){this.makeImpl(!0,r);var o=_.getLostPoint(this);(0==r||o<t)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r);this.make();for(var i=0;i<this.modules.length;i++)for(var n=+i,a=0;a<this.modules[i].length;a++){var s=+a;this.modules[i][a]&&(o.beginFill(0,100),o.moveTo(s,n),o.lineTo(1+s,n),o.lineTo(1+s,1+n),o.lineTo(s,1+n),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=_.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],i=t[r];if(null==this.modules[o][i])for(var n=-2;n<=2;n++)for(var a=-2;a<=2;a++)this.modules[o+n][i+a]=-2==n||2==n||-2==a||2==a||0==n&&0==a}},setupTypeNumber:function(t){for(var e=_.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(r=0;r<18;r++){o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var e=this.errorCorrectLevel<<3|e,r=_.getBCHTypeInfo(e),o=0;o<15;o++){var i=!t&&1==(r>>o&1);o<6?this.modules[o][8]=i:o<8?this.modules[o+1][8]=i:this.modules[this.moduleCount-15+o][8]=i}for(o=0;o<15;o++){i=!t&&1==(r>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=i:o<9?this.modules[8][15-o-1+1]=i:this.modules[8][15-o-1]=i}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,i=7,n=0,a=this.moduleCount-1;0<a;a-=2)for(6==a&&a--;;){for(var s,h,l=0;l<2;l++)null==this.modules[o][a-l]&&(s=!1,n<t.length&&(s=1==(t[n]>>>i&1)),h=_.getMask(e,o,a-l),this.modules[o][a-l]=s=h?!s:s,-1==--i&&(n++,i=7));if((o+=r)<0||this.moduleCount<=o){o-=r,r=-r;break}}}},h.PAD0=236,h.PAD1=17,h.createData=function(t,e,r){for(var o=u.getRSBlocks(t,e),i=new l,n=0;n<r.length;n++){var a=r[n];i.put(a.mode,4),i.put(a.getLength(),_.getLengthInBits(a.mode,t)),a.write(i)}for(var s=0,n=0;n<o.length;n++)s+=o[n].dataCount;if(i.getLengthInBits()>8*s)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+8*s+")");for(i.getLengthInBits()+4<=8*s&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*s)&&(i.put(h.PAD0,8),!(i.getLengthInBits()>=8*s));)i.put(h.PAD1,8);return h.createBytes(i,o)},h.createBytes=function(t,e){for(var r=0,o=0,i=0,n=new Array(e.length),a=new Array(e.length),s=0;s<e.length;s++){var h=e[s].dataCount,l=e[s].totalCount-h,o=Math.max(o,h),i=Math.max(i,l);n[s]=new Array(h);for(var u=0;u<n[s].length;u++)n[s][u]=255&t.buffer[u+r];r+=h;var h=_.getErrorCorrectPolynomial(l),g=new m(n[s],h.getLength()-1).mod(h);a[s]=new Array(h.getLength()-1);for(u=0;u<a[s].length;u++){var f=u+g.getLength()-a[s].length;a[s][u]=0<=f?g.get(f):0}}for(var d=0,u=0;u<e.length;u++)d+=e[u].totalCount;for(var c=new Array(d),p=0,u=0;u<o;u++)for(s=0;s<e.length;s++)u<n[s].length&&(c[p++]=n[s][u]);for(u=0;u<i;u++)for(s=0;s<e.length;s++)u<a[s].length&&(c[p++]=a[s][u]);return c};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},g={L:1,M:0,Q:3,H:2},o=0,i=1,a=2,s=3,f=4,d=5,c=6,p=7,_={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=_.getBCHDigit(e)-_.getBCHDigit(_.G15);)e^=_.G15<<_.getBCHDigit(e)-_.getBCHDigit(_.G15);return(t<<10|e)^_.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=_.getBCHDigit(e)-_.getBCHDigit(_.G18);)e^=_.G18<<_.getBCHDigit(e)-_.getBCHDigit(_.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return _.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case o:return(e+r)%2==0;case i:return e%2==0;case a:return r%3==0;case s:return(e+r)%3==0;case f:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case d:return e*r%2+e*r%3==0;case c:return(e*r%2+e*r%3)%2==0;case p:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new m([1],0),r=0;r<t;r++)e=e.multiply(new m([1,v.gexp(r)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:case n.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;o<e;o++)for(var i=0;i<e;i++){for(var n=0,a=t.isDark(o,i),s=-1;s<=1;s++)if(!(o+s<0||e<=o+s))for(var h=-1;h<=1;h++)i+h<0||e<=i+h||0==s&&0==h||a==t.isDark(o+s,i+h)&&n++;5<n&&(r+=3+n-5)}for(o=0;o<e-1;o++)for(i=0;i<e-1;i++){var l=0;t.isDark(o,i)&&l++,t.isDark(o+1,i)&&l++,t.isDark(o,i+1)&&l++,t.isDark(o+1,i+1)&&l++,0!=l&&4!=l||(r+=3)}for(o=0;o<e;o++)for(i=0;i<e-6;i++)t.isDark(o,i)&&!t.isDark(o,i+1)&&t.isDark(o,i+2)&&t.isDark(o,i+3)&&t.isDark(o,i+4)&&!t.isDark(o,i+5)&&t.isDark(o,i+6)&&(r+=40);for(i=0;i<e;i++)for(o=0;o<e-6;o++)t.isDark(o,i)&&!t.isDark(o+1,i)&&t.isDark(o+2,i)&&t.isDark(o+3,i)&&t.isDark(o+4,i)&&!t.isDark(o+5,i)&&t.isDark(o+6,i)&&(r+=40);for(var u=0,i=0;i<e;i++)for(o=0;o<e;o++)t.isDark(o,i)&&u++;return r+=10*(Math.abs(100*u/e/e-50)/5)}},v={glog:function(t){if(t<1)throw new Error("glog("+t+")");return v.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return v.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},t=0;t<8;t++)v.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)v.EXP_TABLE[t]=v.EXP_TABLE[t-4]^v.EXP_TABLE[t-5]^v.EXP_TABLE[t-6]^v.EXP_TABLE[t-8];for(t=0;t<255;t++)v.LOG_TABLE[v.EXP_TABLE[t]]=t;m.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var o=0;o<t.getLength();o++)e[r+o]^=v.gexp(v.glog(this.get(r))+v.glog(t.get(o)));return new m(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=v.glog(this.get(0))-v.glog(t.get(0)),r=new Array(this.getLength()),o=0;o<this.getLength();o++)r[o]=this.get(o);for(o=0;o<t.getLength();o++)r[o]^=v.gexp(v.glog(t.get(o))+e);return new m(r,0).mod(t)}},u.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],u.getRSBlocks=function(t,e){var r=u.getRsBlockTable(t,e);if(null==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=r.length/3,i=[],n=0;n<o;n++)for(var a=r[3*n+0],s=r[3*n+1],h=r[3*n+2],l=0;l<a;l++)i.push(new u(s,h));return i},u.getRsBlockTable=function(t,e){switch(e){case g.L:return u.RS_BLOCK_TABLE[4*(t-1)+0];case g.M:return u.RS_BLOCK_TABLE[4*(t-1)+1];case g.Q:return u.RS_BLOCK_TABLE[4*(t-1)+2];case g.H:return u.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},l.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var C=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function w(){var t=!1,e=navigator.userAgent;return/android/i.test(e)&&(t=!0,(aMat=e.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(t=parseFloat(aMat[1]))),t}D.prototype.draw=function(t){var e=this._htOption,r=this._el,o=t.getModuleCount();Math.floor(e.width/o),Math.floor(e.height/o);function i(t,e){var r,o=document.createElementNS("http://www.w3.org/2000/svg",t);for(r in e)e.hasOwnProperty(r)&&o.setAttribute(r,e[r]);return o}this.clear();var n=i("svg",{viewBox:"0 0 "+String(o)+" "+String(o),width:"100%",height:"100%",fill:e.colorLight});n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.appendChild(n),n.appendChild(i("rect",{fill:e.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<o;a++)for(var s,h=0;h<o;h++)t.isDark(a,h)&&((s=i("use",{x:String(a),y:String(h)})).setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),n.appendChild(s))},D.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};var r=D;function D(t,e){this._el=t,this._htOption=e}var A="svg"===document.documentElement.tagName.toLowerCase()?r:"undefined"==typeof CanvasRenderingContext2D?(E.prototype.draw=function(t){for(var e=this._htOption,r=this._el,o=t.getModuleCount(),i=Math.floor(e.width/o),n=Math.floor(e.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;s<o;s++){a.push("<tr>");for(var h=0;h<o;h++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+n+"px;background-color:"+(t.isDark(s,h)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),r.innerHTML=a.join("");var r=r.childNodes[0],l=(e.width-r.offsetWidth)/2,u=(e.height-r.offsetHeight)/2;0<l&&0<u&&(r.style.margin=u+"px "+l+"px")},E.prototype.clear=function(){this._el.innerHTML=""},E):function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}var u,g;this._android&&this._android<=2.1&&(u=1/window.devicePixelRatio,g=CanvasRenderingContext2D.prototype.drawImage,CanvasRenderingContext2D.prototype.drawImage=function(t,e,r,o,i,n,a,s,h){if("nodeName"in t&&/img/i.test(t.nodeName))for(var l=arguments.length-1;1<=l;l--)arguments[l]=arguments[l]*u;else void 0===s&&(arguments[1]*=u,arguments[2]*=u,arguments[3]*=u,arguments[4]*=u);g.apply(this,arguments)});function e(t,e){this._bIsPainted=!1,this._android=w(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null}return e.prototype.draw=function(t){var e=this._elImage,r=this._oContext,o=this._htOption,i=t.getModuleCount(),n=o.width/i,a=o.height/i,s=Math.round(n),h=Math.round(a);e.style.display="none",this.clear();for(var l=0;l<i;l++)for(var u=0;u<i;u++){var g=t.isDark(l,u),f=u*n,d=l*a;r.strokeStyle=g?o.colorDark:o.colorLight,r.lineWidth=1,r.fillStyle=g?o.colorDark:o.colorLight,r.fillRect(f,d,n,a),r.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,h),r.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,h)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&!function(t,e){var r=this;r._fFail=e,r._fSuccess=t,null===r._bSupportDataURI?((e=document.createElement("img")).onabort=t=function(){r._bSupportDataURI=!1,r._fFail&&_fFail.call(r)},e.onerror=t,e.onload=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)},e.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="):!0===r._bSupportDataURI&&r._fSuccess?r._fSuccess.call(r):!1===r._bSupportDataURI&&r._fFail&&r._fFail.call(r)}.call(this,t)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(t){return t&&Math.floor(1e3*t)/1e3},e}();function E(t,e){this._el=t,this._htOption=e}function L(t,e){for(var r,o=1,i=(t=t,(r=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a")).length+(r.length!=t?3:0)),n=0,a=C.length;n<=a;n++){var s=0;switch(e){case g.L:s=C[n][0];break;case g.M:s=C[n][1];break;case g.Q:s=C[n][2];break;case g.H:s=C[n][3]}if(i<=s)break;o++}if(C.length<o)throw new Error("Too long data");return o}(y=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:g.H},e="string"==typeof e?{text:e}:e)for(var r in e)this._htOption[r]=e[r];"string"==typeof t&&(t=document.getElementById(t)),this._android=w(),this._el=t,this._oQRCode=null,this._oDrawing=new A(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(t){this._oQRCode=new h(L(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},y.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()},y.prototype.clear=function(){this._oDrawing.clear()},y.CorrectLevel=g}(),r.exports=y});
;/*!wiki-common:widget/component/baikeAppPromote/baikeAppPromote.es.js*/
define("wiki-common:widget/component/baikeAppPromote/baikeAppPromote.es",function(e,o,i){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=a(e("wiki-common:widget/lib/jquery/jquery")),t=a(e("wiki-common:widget/lib/jsmart/jsmart")),d=a(e("wiki-common:widget/util/guid")),r=a(e("wiki-common:widget/component/nslog/nslog")),p=a(e("wiki-common:widget/component/share/dep/qrcode"));function a(e){return e&&e.__esModule?e:{default:e}}function c(e,o){for(var i=0;i<o.length;i++){var a=o[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e=function(){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=this,i=a;if(!(o instanceof i))throw new TypeError("Cannot call a class as a function");this.id=(0,d.default)(),this.domId="#J-wgt-baikeapp-promote-".concat(this.id),this.sfrom=e.sfrom||"normal",this.init()}var e,o,i;return e=a,(o=[{key:"init",value:function(){var e=this,o=new t.default('<div id="J-wgt-baikeapp-promote-{%$id|f_escape_xml%}" class="wgt-baikeapp-promote-container">\n<div id="J-baikeapp-promote-front-{%$id|f_escape_xml%}" class="baikeapp-promote-front">\n<div class="baikeapp-download-qrcode" style="background-image: url({%$qrcode|f_escape_xml%});"></div>\n<div class="baikeapp-download-text">\n<p>下载<b>百度百科APP</b></p>\n<p class="tips">领取<b>50财富值奖励</b></p>\n</div>\n</div>\n<div id="J-baikeapp-promote-end-{%$id|f_escape_xml%}" class="baikeapp-promote-end">\n<div class="baikeapp-download-qrcode" style="background-image: url({%$qrcode|f_escape_xml%});"></div>\n<p class="baikeapp-download-text">百度百科APP</p>\n</div>\n</div>').fetch({id:e.id,qrcode:"https://baikebcs.bdimg.com/baikeapp/qrcode/".concat(e.sfrom,"/download.svg")});(0,n.default)("body").append(o),e.initToggle(),(0,r.default)(21010001),e.initQRCode()}},{key:"initQRCode",value:function(){var i=[45,70],a=[p.default.CorrectLevel.L,p.default.CorrectLevel.Q],t="https://baike.baidu.com/wapui/subpage/baikeappdownload?sfrom="+this.sfrom;(0,n.default)(".wgt-baikeapp-promote-container").find(".baikeapp-download-qrcode").each(function(e,o){new p.default((0,n.default)(o).get(0),{width:i[e],height:i[e],colorDark:"#2673F4",correctLevel:a[e]}).makeCode(t)})}},{key:"initToggle",value:function(){var e=this,o=(0,n.default)("#J-baikeapp-promote-front-".concat(e.id)),i=(0,n.default)("#J-baikeapp-promote-end-".concat(e.id));(0,n.default)("body").on("mouseenter",e.domId,function(){o.hide(),i.show()}),(0,n.default)("body").on("mouseleave",e.domId,function(){o.show(),i.hide()})}}])&&c(e.prototype,o),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}();o.default=e,i.exports=o.default});
;/*!wiki-common:widget/component/cmsModuleLoader/cmsModuleLoader.js*/
define("wiki-common:widget/component/cmsModuleLoader/cmsModuleLoader",function(m,n,e){"use strict";var o=m("wiki-common:widget/lib/jquery/jquery");e.exports=function(n,e){n=n+"?r="+Math.random(),e=e||[];o.getJSON(n,function(n){e[0]&&n[e[0].name]&&!function e(o,i,t){var c=i[t];m.async(i[t].script,function(n){n(o[c.name]),i[t+1]&&o[i[t+1].name]&&e(o,i,t+1)})}(n,e,0)})}});
;/*!wiki-common:widget/component/evtMsgManager/event.js*/
define("wiki-common:widget/component/evtMsgManager/event",function(e,a,m){"use strict";m.exports={LEMMA_AUDIO_PLAY:"lemmaaudioplay",LEMMA_AUDIO_PAUSE:"lemmaaudiopause",LEMMA_VIDEO_PLAY:"lemmavideoplay",LEMMA_VIDEO_PAUSE:"lemmavideopause"}});
;/*!wiki-common:widget/component/evtMsgManager/evtMsgManager.es.js*/
define("wiki-common:widget/component/evtMsgManager/evtMsgManager.es",function(e,t,n){"use strict";var i=e("wiki-common:widget/util/eventEmitter"),e=e("wiki-common:widget/component/evtMsgManager/event"),i=new i;i.Events=e,n.exports=i});
;/*!wiki-common:widget/component/footer/footer_feedback.js*/
define("wiki-common:widget/component/footer/footer_feedback",function(e,t,o){"use strict";var i=e("wiki-common:widget/lib/jquery/jquery");function a(e,t){var o;bds&&bds.qa&&bds.qa.ShortCut&&bds.qa.ShortCut.initRightBar&&(i.extend(o={needImage:!0,upload_file:!0,appid:222641,productLine:90662,wenjuanTitle:"",wenjuanURL:"",issuePlaceholder:"亲爱的百度百科用户，请在此填写您的意见或建议哦～",contactPlaceholder:"请输入邮箱地址，便于及时收到处理结果",showPosition:"center",contactWayType:"email",needContactWay:!0,needHotQuestion:!0,needQuestionnaire:!1,needFeedbackType:!0,needProductType:!1,needEvaluate:!0,typeArray:[{id:"34022",name:"词条内容质疑"},{id:"34028",name:"秒懂内容质疑"},{id:"34029",name:"TA说内容质疑"},{id:"34023",name:"咨询求助"},{id:"48444",name:"产品建议"},{id:"48442",name:"投诉"},{id:"48443",name:"其他"}],titleBgColor:"#FFFFFF",buttonColor:"#3582FA",mainFontColor:"#151515",secondaryFontColor:"#999999",titleColor:"#333333",hotQuestionArray:[{id:93,question:"如何创建词条"},{id:90,question:"词条内容不完善/有误"},{id:92,question:"编辑时提示权限编辑不够"},{id:91,question:"词条未通过审核"}]},e),bds.qa.ShortCut.initRightBar(o),bds.qa.ShortCut._getProData(t))}o.exports=function(e){var o=e.config||{},n=e.proData||{};(e=i(e.el))&&e.on("click",function(){var e,t;e=o,t=n,window.bds&&window.bds.qa&&window.bds.qa.ShortCut?a(e,t):i.getScript("https://ufosdk.baidu.com/Public/feedback/js/dist/feedback_plugin_2.0.js",function(){a(e,t)})})}});
;/*!wiki-common:widget/component/headTabBar/headTabBar.js*/
define("wiki-common:widget/component/headTabBar/headTabBar",function(e,t,a){"use strict";var i=e("wiki-common:widget/lib/jquery/jquery");i(".wiki-common-headTabBar a").not(".gmore").on("click",function(e){e.preventDefault();e=i.trim(i(".wgt-searchbar #query").val());window.location.href=e?i(this).attr("data-href")+encodeURIComponent(e):i(this).attr("href")})});
;/*!wiki-common:widget/component/lemmasInput-n/lemmasInput-n.js*/
define("wiki-common:widget/component/lemmasInput-n/lemmasInput-n",function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var l=n(t("wiki-common:widget/lib/jquery/jquery")),s=n(t("wiki-common:widget/lib/jsmart/jsmart")),m=n(t("wiki-common:widget/ui/dialog/dialog")),i=n(t("wiki-common:widget/ui/tagsInput/tagsInput")),o=n(t("wiki-common:widget/util/safeCall"));function n(t){return t&&t.__esModule?t:{default:t}}function u(e,t){var a,s=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)),s}function c(s){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){var e,a;e=s,a=n[t=t],t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}function r(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var d=new s.default('<dl class="wgt-taskLemmaInput-subLemmasSelectors">\n{%foreach $subLemmas as $subLemma%}\n<dd data-id="{%$subLemma.lemmaId|f_escape_xml%}" data-desc="{%$subLemma.lemmaDesc|f_escape_xml%}" data-feature="{%$subLemma.isFeatured|f_escape_xml%}">\n<a href="javascript: void(0);">{%$lemmaTitle|f_escape_xml%}（{%$subLemma.lemmaDesc|f_escape_xml%}）</a>\n</dd>\n{%/foreach%}\n</dl>\n{%if $enableNotExistedLemma%}\n<div class="wgt-taskLemmaInput-subLemmasInput">\n<input type="text" placeholder="都不是，我要新建义项" class="J-tasklemma-input wgt-taskLemmaInput-input" maxlength="20">\n<span class="J-tasklemma-add wgt-taskLemmaInput-add">+</span>\n</div>\n{%/if%}\n'),p=new s.default('<span class="sticker{%if $className%} {%$className|f_escape_xml%}{%/if%}"\n    {%if $data%}\n        {%foreach $data as $key => $value%}\n        data-{%$key%}="{%$value|f_escape_xml%}"\n        {%/foreach%}\n    {%/if%}\n>\n<span class="tag-con">{%$text|trim|escape|f_escape_xml%}</span>\n{%if $dom%}\n{%$dom|escape:none%}\n{%/if%}\n<a href="javascript:void(0);" class="remove">×</a>\n</span>\n'),t=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this,a=n;if(!(e instanceof a))throw new TypeError("Cannot call a class as a function");if(!t)throw new Error("[TaskLemmaInput Exception]: No arguments.");if(!(0,l.default)(t.container).length)throw new Error('[TaskLemmaInput Exception]: Invalid argument "container".');var s=this;this._init(t),0<this.lemmaList.length&&l.default.each(this.lemmaList,function(t,e){s.tagsInputInstance.addTags([{text:"".concat(e.lemmaTitle).concat(e.lemmaDesc?"（".concat(e.lemmaDesc,"）"):""),data:{lemmaId:e.lemmaId,lemmaTitle:e.lemmaTitle,lemmaDesc:e.lemmaDesc||""}}])}),this._setInputBoxStatus(),this._createSug(),this._eventBind(),this.tagsInputInstance.tagsInput.on("keyup mouseup",function(){s._setContent()}),this._polysemeBind(),this._nonExistBind(),this.enableFeatureLemma||this._featureBind()}var t,e,a;return t=n,(e=[{key:"_init",value:function(t){var e=this,a=(this.container=(0,l.default)(t.container),this.container.html(['<div class="wgt-taskLemmaInput-pool">','<div class="wgt-taskLemmaInput-input-container">',"<pre></pre>",'<textarea placeholder="'+(t.placeholder||"")+'" class="wgt-taskLemmaInput-input"></textarea>',"</div>","</div>",'<ul class="wgt-taskLemmaInput-suggestion"></ul>'].join("")),this.tagsBox=this.container.find(".wgt-taskLemmaInput-pool"),this.tagsInput=this.container.find(".wgt-taskLemmaInput-input"),this.sugBox=this.container.find(".wgt-taskLemmaInput-suggestion"),this.tagsMaxCount=isNaN(parseInt(t.tagsMaxCount,10))?1/0:Math.abs(parseInt(t.tagsMaxCount,10)),this.enableNotExistedLemma=t.enableNotExistedLemma||!1,this.enableFeatureLemma=t.enableFeatureLemma||!1,this.disableRedirectFilter=t.disableRedirectFilter||!1,this.onTagAdd=t.onTagAdd,this.onTagRemove=t.onTagRemove,this.onTagsInputComplete=t.onTagsInputComplete,this.lemmaList=t.lemmaList&&0<t.lemmaList.length?t.lemmaList:[],this.polysemes=[],this.features=[],this);this.tagsInputInstance=new i.default({tagsBox:this.tagsBox,tagsInput:this.tagsInput,tagsMaxCount:this.tagsMaxCount,TriggerTagAdd:"ENTER",ignoreSpace:!0,validation:function(t){l.default.ajax({type:"POST",url:"/api/common/checklemmatitles",data:{lemmaTitles:t.join("\n"),redirectFilter:a.disableRedirectFilter?1:0},dataType:"JSON",success:function(t){t.errno||e._handleValidation(t.data)}})},onTagRemove:function(t){e._setInputBoxStatus(),e._setSugStatus(),(0,o.default)(this.onTagRemove,[t],e)}})}},{key:"_handleValidation",value:function(t){var e=this;t.lemmaList.map(function(t){(0,l.default)(".tag",e.tagsInputInstance.tagsBox).length+(0,l.default)(".sticker",e.tagsInputInstance.tagsBox).length<e.tagsMaxCount&&e._handlePolyseme(t)}),t.notExists.map(function(t){(0,l.default)(".tag",e.tagsInputInstance.tagsBox).length+(0,l.default)(".sticker",e.tagsInputInstance.tagsBox).length<e.tagsMaxCount&&e._handleNonexist(t)}),this._setSugStatus()}},{key:"_checkFeatureLemmaStatus",value:function(t){t.lemmaInfo[0].isFeatured&&this.features.push(t),!this.enableFeatureLemma&&t.lemmaInfo[0].isFeatured?this._handleFeature(t):this._handleAlready(t)}},{key:"_handleAlready",value:function(t){var e=this.tagsInputInstance.addTagHandle({text:"".concat(t.lemmaTitle).concat(t.lemmaDesc?"（".concat(t.lemmaDesc,"）"):""),data:{lemmaId:t.lemmaInfo&&t.lemmaInfo[0].lemmaId||"0",lemmaTitle:t.lemmaTitle,lemmaDesc:t.lemmaDesc||"",isFeatured:t.lemmaInfo&&t.lemmaInfo[0].isFeatured||0}});(0,o.default)(this.onTagAdd,[["".concat(t.lemmaTitle).concat(t.lemmaDesc?"（".concat(t.lemmaDesc,"）"):"")],e],this),this._setTagsInputInstanceStatus(),this._setInputBoxStatus(),this._removeFromInputBox(t.lemmaTitle)}},{key:"_handlePolyseme",value:function(t){this.polysemes.push(t);var e=p.fetch({text:t.lemmaTitle,className:"polysemant",dom:['<a href="javascript: void(0);" class="J-tasklemma-unfold">','<em class="cmn-icon cmn-icons cmn-icons_userbar-up"></em>',"</a>"].join(""),data:{title:t.lemmaTitle}});this._setStickerStatus(e,t.lemmaTitle)}},{key:"_handleNonexist",value:function(t){var e=p.fetch({text:t,className:"nonexist",dom:this.enableNotExistedLemma?'<a href="javascript: void(0);" class="J-tasklemma-add">添加</a>':"",data:{title:t}});this.enableNotExistedLemma||(0,l.default)(e).addClass("disable-click"),this._setStickerStatus(e,t)}},{key:"_handleFeature",value:function(t){var e=p.fetch({text:"".concat(t.lemmaTitle).concat(t.lemmaDesc?"（".concat(t.lemmaDesc,"）"):""),className:"feature",data:{id:t.lemmaInfo&&t.lemmaInfo[0].lemmaId||"0",title:t.lemmaTitle,desc:t.lemmaDesc||"",isFeatured:t.lemmaInfo[0].isFeatured}});this._setStickerStatus(e,t.lemmaTitle)}},{key:"_setStickerStatus",value:function(t,e){this.tagsBox.find(".wgt-taskLemmaInput-input-container").before(t),this._setContent(),this._removeFromInputBox(e)}},{key:"_createSug",value:function(){this.sugBox.html(['<li class="nonexist-selector">','<div>未收录词条<span class="nonexist-selector-num"></span>个。','（<span class="nonexist-selector-cur">1</span>/<span class="nonexist-selector-num"></span>） ','<a href="javascript: void(0);" class="nonexist-selector-next">查看</a>',"&nbsp;&nbsp;|&nbsp;&nbsp;",this.enableNotExistedLemma?'<a href="javascript: void(0);" class="nonexist-selector-all">添加全部</a>':"请修改或替换","</div>","</li>"].join("")),this.sugBox.append(['<li class="polysemant-selector">','<div>未选择义项的词条<span class="polysemant-selector-num"></span>个，需要',this.enableNotExistedLemma?"选择或创建":"选择","义项，否则无法添加到任务中。",'（<span class="polysemant-selector-cur">1</span>/<span class="polysemant-selector-num"></span>）','<a href="javascript: void(0);" class="polysemant-selector-next">查看</a>',"</div>","</li>"].join("")),this.enableFeatureLemma||this.sugBox.append(['<li class="feature-selector">','<div>特色词条<span class="feature-selector-num"></span>个，特色词条仅熟练任务可以添加，当前难度不可添加，请删除。','（<span class="feature-selector-cur">1</span>/<span class="feature-selector-num"></span>）','<a href="javascript: void(0);" class="feature-selector-next">查看下一个</a>',"&nbsp;&nbsp;|&nbsp;&nbsp;",'<a href="javascript: void(0);" class="feature-selector-all">删除全部</a>',"</div>","</li>"].join("")),this.tagsBox.append('<div class="wgt-taskLemmaInput-cover"></div>')}},{key:"_eventBind",value:function(){var t=this;this.tagsBox.on("click",".tag .remove",function(){(0,l.default)(this).parent(".tag").remove(),t._setSugStatus()})}},{key:"_polysemeBind",value:function(){var o=this,t=[];this.tagsBox.on("click",".polysemant .J-tasklemma-unfold",function(){var s=(0,l.default)(this).parent(".polysemant").data("title"),n=o.polysemes.find(function(t){return t.lemmaTitle===s||+t.lemmaTitle==+s}),i=new m.default({icon:"CHECK",title:"请选择义项",type:"BUBBLE",classNames:"wgt-taskLemmaInput-subLemmasSelectors-bubble",host:(0,l.default)(this),pos:"rightTop",marginFromHost:5,content:d.fetch({lemmaTitle:s,subLemmas:n.lemmaInfo,enableNotExistedLemma:o.enableNotExistedLemma})});i.node.on("click",".wgt-taskLemmaInput-subLemmasSelectors a",function(){var t=(0,l.default)(this).parent("dd");o._checkFeatureLemmaStatus({lemmaTitle:s,lemmaDesc:t.data("desc"),lemmaInfo:[{lemmaId:t.data("id"),isFeatured:t.data("feature")||0}]}),o.tagsBox.find('.polysemant[data-title="'+s+'"]').remove(),o._setSugStatus(),i.hide()}).on("click",".wgt-taskLemmaInput-subLemmasInput .J-tasklemma-add",function(){var t,e,a=(0,l.default)(this).siblings(".J-tasklemma-input").val();a&&(t=n.lemmaInfo.find(function(t){return t.lemmaDesc===a}),e=(0,l.default)(this).parent(".wgt-taskLemmaInput-subLemmasInput").siblings(".wgt-taskLemmaInput-err"),t?e&&e.length?e.show():(0,l.default)(this).parent(".wgt-taskLemmaInput-subLemmasInput").before('<div class="wgt-taskLemmaInput-err errMsg">当前义项名已经存在，请核对后重新输入</div>'):(o._handleAlready({lemmaTitle:s,lemmaDesc:a}),o.tagsBox.find('.polysemant[data-title="'+s+'"]').remove(),o._setSugStatus(),i.hide())),setTimeout(function(){(0,l.default)(".wgt-taskLemmaInput-err").hide()},3e3)}).on("keyup",".wgt-taskLemmaInput-subLemmasInput",function(t){8===t.keyCode&&(0,l.default)(".wgt-taskLemmaInput-err").hide()}),i.show(),t.forEach(function(t){t.hide()}),(t=[]).push(i)}).on("click",".polysemant .remove",function(){(0,l.default)(this).parent(".polysemant").remove(),o._setSugStatus()}),this.sugBox.on("click",".polysemant-selector-next",function(){o._lookOver("polysemant",(0,l.default)(this))})}},{key:"_nonExistBind",value:function(){var t=this;this.enableNotExistedLemma&&(this.tagsBox.on("click",".nonexist .J-tasklemma-add",function(){t._handleAlready({lemmaTitle:(0,l.default)(this).parent(".nonexist").data("title")}),(0,l.default)(this).parent(".nonexist").remove(),t._setSugStatus()}),this.sugBox.on("click",".nonexist-selector-all",function(){t.tagsBox.find(".nonexist").find(".J-tasklemma-add").click()})),this.tagsBox.on("click",".nonexist .remove",function(){(0,l.default)(this).parent(".nonexist").remove(),t._setSugStatus()}),this.sugBox.on("click",".nonexist-selector-next",function(){t._lookOver("nonexist",(0,l.default)(this))})}},{key:"_featureBind",value:function(){var t=this;this.tagsBox.on("click",".feature .remove",function(){(0,l.default)(this).parent(".feature").remove(),t._setSugStatus()}),this.sugBox.on("click",".feature-selector-all",function(){t.tagsBox.find(".feature").find(".remove").click()}).on("click",".feature-selector-next",function(){t._lookOver("feature",(0,l.default)(this))})}},{key:"_lookOver",value:function(t,e){var a=this.tagsBox.find(".".concat(t)),t=e.siblings(".".concat(t,"-selector-cur")),s=+t.text();1<a.length&&("查看"===e.text()?e.text("查看下一个"):(s===a.length?s=1:s+=1,t.text(s))),this._tagsBoxScrollTo(a.eq(s-1))}},{key:"_tagsBoxScrollTo",value:function(t){var e;t.length&&this.tagsBox.find(t).length&&(this.tagsBox.find(".sticker").removeClass("focus"),t.addClass("focus"),t=t.offset().top,e=this.tagsBox.offset().top,this.tagsBox.scrollTop(t+this.tagsBox.scrollTop()-e-5))}},{key:"_setContent",value:function(){var t=this.tagsInputInstance.tagsInput.val();this.tagsInputInstance.tagsBox.find(".wgt-taskLemmaInput-input-container pre").html(t+"<br/><br/>")}},{key:"_setSugStatus",value:function(){this.tagsBox.find(".sticker").removeClass("focus"),this._setSugItem("polysemant"),this._setSugItem("nonexist"),this.enableFeatureLemma||this._setSugItem("feature"),(0,l.default)(".tag",this.tagsInputInstance.tagsBox).length>=this.tagsMaxCount?this.sugBox.hide():this.sugBox.show()}},{key:"_setSugItem",value:function(t){var e=this.tagsBox.find(".".concat(t)).length;0<e?(this.sugBox.show(),this.sugBox.find(".".concat(t,"-selector")).show(),this.sugBox.find(".".concat(t,"-selector-num")).text(e),this.sugBox.find(".".concat(t,"-selector-cur")).text(1),this.sugBox.find(".".concat(t,"-selector-next")).text("查看")):(this.sugBox.find(".".concat(t,"-selector-num")).text(""),this.sugBox.find(".".concat(t,"-selector")).hide())}},{key:"_setTagsInputInstanceStatus",value:function(){var t=(0,l.default)(".tag",this.tagsInputInstance.tagsBox);t.length>=this.tagsMaxCount&&(0,o.default)(this.onTagsInputComplete,[(0,l.default)(".tag-con",t).map(function(){return(0,l.default)(this).text()}),t],this)}},{key:"_removeFromInputBox",value:function(a){var t=this.tagsInputInstance.tagsInput.val().split("\n"),s=[],t=(l.default.each(t,function(t,e){e=l.default.trim(e);e&&""!==e&&e!==a&&s.push(e)}),s.join("\n"));0<s.length&&(t+="\n"),this.tagsInputInstance.tagsInput.val(t)}},{key:"_setInputBoxStatus",value:function(){(0,l.default)(".tag",this.tagsInputInstance.tagsBox).length>=this.tagsMaxCount?(this.tagsInputInstance.tagsInput.hide(),this.tagsInputInstance.tagsBox.find(".wgt-taskLemmaInput-input-container pre").hide()):(this.tagsInputInstance.tagsInput.show(),this.tagsInputInstance.tagsBox.find(".wgt-taskLemmaInput-input-container pre").show()),this._setContent()}},{key:"getLemmas",value:function(){var t=this.tagsInputInstance.getTags(),e=[];return t.map(function(t){e.push({lemmaTitle:t.data.lemmaTitle,lemmaId:parseInt(t.data.lemmaId,10)||0,lemmaDesc:t.data.lemmaDesc})}),e}},{key:"feature2ready",value:function(){var e=this;this.enableFeatureLemma=!0,this.features&&this.features.length&&this.features.map(function(t){e._handleAlready(t)}),this.tagsBox.find(".feature").remove(),this._setSugItem("feature")}},{key:"ready2feature",value:function(){var a=this,t=(this.enableFeatureLemma=!1,this.tagsInputInstance.getTags()),s=(0,l.default)(".tag",this.tagsInputInstance.tagsBox);t.map(function(t){var e;t.data.isFeatured&&(e=c(c({},t.data),{},{lemmaInfo:[{lemmaId:t.data.lemmaId,isFeatured:1}]}),a._handleFeature(e),s.each(function(){(0,l.default)(this).find(".tag-con").text()===t.text&&(0,l.default)(this).remove()}))}),this._setSugItem("feature")}}])&&r(t.prototype,e),a&&r(t,a),Object.defineProperty(t,"prototype",{writable:!1}),n}();e.default=t,a.exports=e.default});
;/*!wiki-common:widget/component/lemmasInput/lemmasInput.js*/
define("wiki-common:widget/component/lemmasInput/lemmasInput",function(t,e,a){"use strict";var o=t("wiki-common:widget/lib/jquery/jquery"),s=t("wiki-common:widget/lib/jsmart/jsmart"),d=t("wiki-common:widget/util/safeCall"),n=(t("wiki-common:widget/util/string"),t("wiki-common:widget/ui/tagsInput/tagsInput")),c=t("wiki-common:widget/ui/dialog/dialog"),u=new s('{%if $searchInput%}\n<div class="wgt-lemmasInput-subLemmasSearch">\n<input type="text" placeholder="搜索义项" class="J-lemma-search">\n</div>\n{%/if%}\n<dl class="wgt-lemmasInput-subLemmasSelectors">\n{%foreach $subLemmas as $subLemma%}\n<dd data-lemmaId="{%$subLemma.lemmaId|f_escape_xml%}" data-lemmaTitle="{%$lemmaTitle|f_escape_xml%}" {%if $subLemma.isSub%}data-issub="{%$subLemma.isSub|f_escape_xml%}"{%/if%}><a href="javascript:;">{%$subLemma.lemmaDesc|f_escape_xml%}</a></dd>\n{%/foreach%}\n</dl>\n');function h(){var t=this.tagsInputInstance.tagsInput.val();this.tagsInputInstance.tagsBox.find(".wgt-lemmasInput-input-container pre").html(t+"<br/><br/>")}function g(){0<this.sugBox.find(".polysemant-selector dd").find("span").length?(this.sugBox.show(),this.sugBox.find(".polysemant-selector").show()):this.sugBox.find(".polysemant-selector").hide(),0<this.sugBox.find(".not-existed-selector dd").find("span").length?(this.sugBox.show(),this.sugBox.find(".not-existed-selector").show()):this.sugBox.find(".not-existed-selector").hide(),o(".tag",this.tagsInputInstance.tagsBox).length>=this.tagsMaxCount?this.sugBox.hide():this.sugBox.show()}function p(){o(".tag",this.tagsInputInstance.tagsBox).length>=this.tagsMaxCount?(this.tagsInputInstance.tagsInput.hide(),this.tagsInputInstance.tagsBox.find(".wgt-lemmasInput-input-container pre").hide()):(this.tagsInputInstance.tagsInput.show(),this.tagsInputInstance.tagsBox.find(".wgt-lemmasInput-input-container pre").show()),h.call(this)}function r(){var t=o(".tag",this.tagsInputInstance.tagsBox);t.length>=this.tagsMaxCount&&d(this.onTagsInputComplete,[o(".tag-con",t).map(function(){return o(this).text()}),t],this)}function I(a){var t=this.tagsInputInstance.tagsInput.val().split("\n"),s=[],t=(o.each(t,function(t,e){(e=o.trim(e))&&""!==e&&e!==a&&s.push(e)}),s.join("\n"));0<s.length&&(t+="\n"),this.tagsInputInstance.tagsInput.val(t)}function i(t){if(!t)throw new Error("[LemmasInput Exception]: No arguments.");if(!o(t.container).length)throw new Error('[LemmasInput Exception]: Invalid argument "container".');var i=this,m=(this.container=o(t.container).addClass("cmn-clearfix"),this.container.html('<div class="wgt-lemmasInput-suggestion"></div><div class="wgt-lemmasInput-pool"><div class="wgt-lemmasInput-input-container"><pre></pre><textarea placeholder="'+(t.placeholder||"")+'" class="wgt-lemmasInput-input"></textarea></div></div>'),this.tagsBox=this.container.find(".wgt-lemmasInput-pool"),this.tagsInput=this.container.find(".wgt-lemmasInput-input"),this.sugBox=this.container.find(".wgt-lemmasInput-suggestion"),this.tagsMaxCount=isNaN(parseInt(t.tagsMaxCount))?1/0:Math.abs(parseInt(t.tagsMaxCount)),this.enableNotExistedLemma=t.enableNotExistedLemma||!1,this.onTagAdd=t.onTagAdd,this.onTagRemove=t.onTagRemove,this.onTagsInputComplete=t.onTagsInputComplete,this.searchInput=t.searchInput,this.addSubLemma=t.addSubLemma,this.clickRemove=t.clickRemove,this.pos=t.pos,this.lemmaList=t.lemmaList&&0<t.lemmaList.length?t.lemmaList:[],this.tagsInputInstance=new n({tagsBox:this.tagsBox,tagsInput:this.tagsInput,tagsMaxCount:this.tagsMaxCount,TriggerTagAdd:"BLUR|ENTER",ignoreSpace:!0,clickRemove:i.clickRemove,validation:function(t){o.ajax({type:"POST",url:"/api/common/checklemmatitles",data:{lemmaTitles:t.join("\n")},dataType:"JSON",success:function(t){t.errno||(i.addSubLemma&&(t.data.lemmaList=t.data.lemmaList.map(function(t){return t.lemmaInfo.push({lemmaDesc:"新增义项",lemmaId:0,isSub:!0}),t})),function(t){for(var e in this.sugBox.find(".polysemant-selector dd").html(""),this.sugBox.find(".not-existed-selector dd").html(""),t.lemmaList){var a;1===t.lemmaList[e].lemmaInfo.length?o(".tag",this.tagsInputInstance.tagsBox).length<this.tagsMaxCount&&(a=this.tagsInputInstance.addTagHandle({text:t.lemmaList[e].lemmaTitle,data:{lemmaId:t.lemmaList[e].lemmaInfo[0].lemmaId,lemmaTitle:t.lemmaList[e].lemmaTitle,lemmaDesc:""}}),d(this.onTagAdd,[[t.lemmaList[e].lemmaTitle],a],this),r.call(this),p.call(this),I.call(this,t.lemmaList[e].lemmaTitle)):(s=o("<a>").attr({href:"javascript:;"}).data({lemmaTitle:t.lemmaList[e].lemmaTitle,subLemmas:t.lemmaList[e].lemmaInfo}).text(t.lemmaList[e].lemmaTitle),n=o("<span>").attr("data-lemmaTitle",t.lemmaList[e].lemmaTitle).html(s),this.sugBox.find(".polysemant-selector dd").append(n),h.call(this))}for(var e in t.notExists){var s=o("<a>").attr({href:"javascript:;"}).data({lemmaTitle:t.notExists[e]}).text(t.notExists[e]),n=o("<span>").attr("data-lemmaTitle",t.notExists[e]).html(s);this.enableNotExistedLemma||n.addClass("disable-click"),this.sugBox.find(".not-existed-selector dd").append(n),h.call(this)}g.call(this)}.call(i,t.data))}})},onTagRemove:function(t,e){p.call(i),g.call(i),d(this.onTagRemove,[t,e],i)}}),0<this.lemmaList.length&&o.each(this.lemmaList,function(t,e){i.tagsInputInstance.addTagHandle({text:e.lemmaDesc?e.lemmaTitle+"（"+e.lemmaDesc+"）":e.lemmaTitle,data:{lemmaId:e.lemmaId,lemmaTitle:e.lemmaTitle,lemmaDesc:e.lemmaDesc||""}})}),p.call(this),this.sugBox.html('<dl class="polysemant-selector"><dt>以下词条是多义词，请指定具体义项：</dt><dd></dd></dl>'),this.sugBox.append('<dl class="not-existed-selector"><dt>以下是不存在的词条，'+(this.enableNotExistedLemma?'点击仍然添加<br/><a href="javascript:;" class="cmn-btn-white-blue">添加以下所有词条</a>':"请修改或替换")+"</dt><dd></dd></dl>"),this.tagsBox.append('<div class="wgt-lemmasInput-cover"></div>'),this.tagsInputInstance.tagsInput.on("keyup mouseup",function(){h.call(i)}),""),l=[];this.sugBox.find(".polysemant-selector dd").on("mouseenter","a",function(){var t,e=this,a=o(this).data().lemmaTitle,s=o(this).data().subLemmas,n=new c({icon:"CHECK",title:"请选择义项",type:"BUBBLE",classNames:"wgt-lemmasInput-subLemmasSelectors-bubble",host:o(this),pos:i.pos||"righttop",marginFromHost:5,onShow:function(){var e;i.searchInput&&(e=this.node.find(".wgt-lemmasInput-subLemmasSelectors dd"),this.node.find(".J-lemma-search").on("input",function(t){var a=o(this).val();a.length?e.each(function(t,e){-1<(e=o(e)).text().indexOf(a)?e.show():e.hide()}):e.show()}))},onHide:function(){this.node.remove()},content:u.fetch({lemmaTitle:a,subLemmas:s,searchInput:i.searchInput})});for(t in n.node.on("click",".wgt-lemmasInput-subLemmasSelectors a",function(){var t=o(this).parent("dd"),e=t.attr("data-lemmaTitle"),a=t.attr("data-lemmaId"),s=t.attr("data-issub"),t=t.text(),a=i.tagsInputInstance.addTagHandle({text:e+"（"+t+"）",data:{lemmaId:a,lemmaTitle:e,lemmaDesc:t,isSub:s}});d(i.onTagAdd,[[e+"（"+t+"）"],a],i),r.call(i),p.call(i),I.call(i,e),i.sugBox.find(".polysemant-selector dd").find('span[data-lemmaTitle="'+e+'"]').remove(),g.call(i),n.hide(),i.tagsInputInstance.tagsInput.focus()}),n.show(),l)l[t].hide();(l=[]).push(n),o(e).on("mouseleave",function(){m=setTimeout(function(){o(e).off("mouseleave"),n.hide()},150)}),n.node.on("mouseenter",function(){clearTimeout(m)}).on("mouseleave",function(){m=setTimeout(function(){o(e).off("mouseleave"),n.hide()},150)})}),this.enableNotExistedLemma&&(this.sugBox.find(".not-existed-selector dd").on("click","a",function(){var t=o(this).data().lemmaTitle,e=i.tagsInputInstance.addTagHandle({text:t,data:{lemmaId:"0",lemmaTitle:t,lemmaDesc:""}});d(i.onTagAdd,[[t+"（"+t+"）"],e],i),r.call(i),p.call(i),I.call(i,t),i.sugBox.find(".not-existed-selector dd").find('span[data-lemmaTitle="'+t+'"]').remove(),g.call(i),i.tagsInputInstance.tagsInput.focus()}),this.sugBox.find(".not-existed-selector dt").on("click","a",function(){o(this).parent().siblings("dd").find("a").click()}))}i.prototype={constructor:i,getLemmas:function(){var t,e=this.tagsInputInstance.getTags(),a=[];for(t in e)a.push({lemmaTitle:e[t].data.lemmaTitle,lemmaId:parseInt(e[t].data.lemmaId)||0,lemmaDesc:e[t].data.lemmaDesc});return a}},a.exports=i});
;/*!wiki-common:widget/component/picUploader/Jcrop/Jcrop.js*/
define("wiki-common:widget/component/picUploader/Jcrop/Jcrop",function(e,t,n){n.exports=function(Ze){Ze.Jcrop=function(e,t){var w=Ze.extend({},Ze.Jcrop.defaults),A=navigator.userAgent.toLowerCase(),R=/msie/.test(A),A=/msie [1-6]\./.test(A);function i(e){return Math.round(e)+"px"}function r(e){return w.baseClass+"-"+e}function c(e){e=Ze(e).offset();return[e.left,e.top]}function n(e){return[e.pageX-m[0],e.pageY-m[1]]}function T(e){w=Ze.extend(w,e="object"!=typeof e?{}:e),Ze.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof w[t]&&(w[t]=function(){})})}function K(e,t,n){if(m=c(u),B.setCursor("move"===e?e:e+"-resize"),"move"===e)return B.activateHandlers((o=t,qe.watchKeys(),function(e){M.moveOffset([e[0]-o[0],e[1]-o[1]]),o=e,I.update()}),L,n);var o,i,r,t=M.getFixed(),a=E(e),s=M.getCorner(E(a));M.setPressed(M.getCorner(a)),M.setCurrent(s),B.activateHandlers((i=e,r=t,function(e){if(w.aspectRatio)switch(i){case"e":case"w":e[1]=r.y+1;break;case"n":case"s":e[0]=r.x+1}else switch(i){case"e":case"w":e[1]=r.y2;break;case"n":case"s":e[0]=r.x2}M.setCurrent(e),I.update()}),L,n)}function E(e){switch(e){case"n":return"sw";case"s":case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function W(t){return function(e){return w.disabled||"move"===t&&!w.allowMove||(m=c(u),o=!0,K(t,n(e)),e.stopPropagation(),e.preventDefault()),!1}}function Y(e,t,n){var o=e.width(),i=e.height();n<(i=t<o&&0<t?(o=t)/e.width()*e.height():i)&&0<n&&(o=(i=n)/e.height()*e.width()),v=e.width()/o,y=e.height()/i,e.width(o).height(i)}function q(e){return{x:e.x*v,y:e.y*y,x2:e.x2*v,y2:e.y2*y,w:e.w*v,h:e.h*y}}function L(e){var t=M.getFixed();t.w>w.minSelect[0]&&t.h>w.minSelect[1]?(I.enableHandles(),I.done()):I.release(),B.setCursor(w.allowSelect?"crosshair":"default")}function X(e){if(w.disabled)return!1;if(!w.allowSelect)return!1;o=!0,m=c(u),I.disableHandles(),B.setCursor("crosshair");var t=n(e);return M.setPressed(t),I.update(),B.activateHandlers(G,L,"touch"===e.type.substring(0,5)),qe.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function G(e){M.setCurrent(e),I.update()}function N(){var e=Ze("<div></div>").addClass(r("tracker"));return R&&e.css({opacity:0,backgroundColor:"white"}),e}"object"!=typeof e&&(e=Ze(e)[0]),T(t="object"!=typeof t?{}:t);var u,V,U,Q,Z,v,y,o,$,t={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},a=Ze(e),_=!0,h=("IMG"==e.tagName?(0!=a[0].width&&0!=a[0].height?(a.width(a[0].width),a.height(a[0].height)):((Ye=new Image).src=a[0].src,a.width(Ye.width),a.height(Ye.height)),(u=a.clone().removeAttr("id").css(t).show()).width(a.width()),u.height(a.height()),a.after(u).hide()):(u=a.css(t).show(),_=!1,null===w.shade&&(w.shade=!0)),Y(u,w.boxWidth,w.boxHeight),u.width()),f=u.height(),s=Ze("<div />").width(h).height(f).addClass(r("holder")).css({position:"relative",backgroundColor:w.bgColor}).insertAfter(a).append(u),d=(w.addClass&&s.addClass(w.addClass),Ze("<div />")),ee=Ze("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),l=Ze("<div />").width("100%").height("100%").css("zIndex",320),p=Ze("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=M.getFixed();w.onDblClick.call(P,e)}).insertBefore(u).append(ee,l),g=(_&&(d=Ze("<img />").attr("src",u.attr("src")).css(t).width(h).height(f),ee.append(d)),A&&p.css({overflowY:"hidden"}),w.boundary),b=N().width(h+2*g).height(f+2*g).css({position:"absolute",top:i(-g),left:i(-g),zIndex:290}).mousedown(X),te=w.bgColor,ne=w.bgOpacity,m=c(u),x={createDragger:function(t){return function(e){return w.disabled||"move"===t&&!w.allowMove||(m=c(u),o=!0,K(t,n(x.cfilter(e)),!0),e.stopPropagation(),e.preventDefault()),!1}},newSelection:function(e){return X(x.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:oe,support:!0===w.touchSupport||!1===w.touchSupport?w.touchSupport:oe()};function oe(){var e,t={},n=["touchstart","touchmove","touchend"],o=document.createElement("div");try{for(e=0;e<n.length;e++){var i,r=(i="on"+n[e])in o;r||(o.setAttribute(i,"return;"),r="function"==typeof o[i]),t[n[e]]=r}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}z=k=S=C=0;var ie,re,C,S,k,z,M={flipCoords:ce,setPressed:function(e){e=se(e),k=C=e[0],z=S=e[1]},setCurrent:function(e){e=se(e),ie=e[0]-k,re=e[1]-z,k=e[0],z=e[1]},getOffset:function(){return[ie,re]},moveOffset:function(e){var t=e[0],e=e[1];C+t<0&&(t-=t+C),S+e<0&&(e-=e+S),f<z+e&&(e+=f-(z+e)),h<k+t&&(t+=h-(k+t)),C+=t,k+=t,S+=e,z+=e},getCorner:function(e){var t=ae();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}},getFixed:ae};function ae(){if(!w.aspectRatio)return r=k-C,i=z-S,V&&Math.abs(r)>V&&(k=0<r?C+V:C-V),U&&Math.abs(i)>U&&(z=0<i?S+U:S-U),Z/y&&Math.abs(i)<Z/y&&(z=0<i?S+Z/y:S-Z/y),Q/v&&Math.abs(r)<Q/v&&(k=0<r?C+Q/v:C-Q/v),C<0&&(k-=C,C-=C),S<0&&(z-=S,S-=S),k<0&&(C-=k,k-=k),z<0&&(S-=z,z-=z),h<k&&(C-=a=k-h,k-=a),f<z&&(S-=a=z-f,z-=a),h<C&&(z-=a=C-f,S-=a),f<S&&(z-=a=S-f,S-=a),ue(ce(C,S,k,z));var e,t,n,o,i=w.aspectRatio,r=w.minSize[0]/v,a=w.maxSize[0]/v,s=w.maxSize[1]/y,c=k-C,u=z-S,d=Math.abs(c),l=Math.abs(u);return 0===a&&(a=10*h),0==s&&0,d/l<i?(t=z,n=l*i,(e=c<0?C-n:n+C)<0?(e=0,o=Math.abs((e-C)/i),t=u<0?S-o:o+S):h<e&&(e=h,o=Math.abs((e-C)/i),t=u<0?S-o:o+S)):(e=k,o=d/i,(t=u<0?S-o:S+o)<0?(t=0,n=Math.abs((t-S)*i),e=c<0?C-n:n+C):f<t&&(t=f,n=Math.abs(t-S)*i,e=c<0?C-n:n+C)),C<e?(e-C<r?e=C+r:a<e-C&&(e=C+a),t=S<t?S+(e-C)/i:S-(e-C)/i):e<C&&(C-e<r?e=C-r:a<C-e&&(e=C-a),t=S<t?S+(C-e)/i:S-(C-e)/i),e<0?(C-=e,e=0):h<e&&(C-=e-h,e=h),t<0?(S-=t,t=0):f<t&&(S-=t-f,t=f),ue(ce(C,S,e,t))}function se(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>h&&(e[0]=h),e[1]>f&&(e[1]=f),[Math.round(e[0]),Math.round(e[1])]}function ce(e,t,n,o){var i=e,r=n,a=t,s=o;return n<e&&(i=n,r=e),o<t&&(a=o,s=t),[i,a,r,s]}function ue(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}O=!1,F=Ze("<div />").css({position:"absolute",zIndex:240,opacity:0}),j={top:he(),left:he().height(f),right:he().height(f),bottom:he()};var O,F,j,H={update:de,updateRaw:le,getShades:we,setBgColor:pe,enable:fe,disable:ge,resize:function(e,t){j.left.css({height:i(t)}),j.right.css({height:i(t)})},refresh:function(){(w.shade?fe:ge)(),I.isAwake()&&be(w.bgOpacity)},opacity:be};function de(){return le(M.getFixed())}function le(e){j.top.css({left:i(e.x),width:i(e.w),height:i(e.y)}),j.bottom.css({top:i(e.y2),left:i(e.x),width:i(e.w),height:i(f-e.y2)}),j.right.css({left:i(e.x2),width:i(h-e.x2)}),j.left.css({width:i(e.x)})}function he(){return Ze("<div />").css({position:"absolute",backgroundColor:w.shadeColor||w.bgColor}).appendTo(F)}function fe(){O||(O=!0,F.insertBefore(u),de(),I.setBgOpacity(1,0,1),d.hide(),pe(w.shadeColor||w.bgColor,1),I.isAwake()?be(w.bgOpacity,1):be(1,1))}function pe(e,t){Ue(we(),e,t)}function ge(){O&&(F.remove(),d.show(),O=!1,I.isAwake()?I.setBgOpacity(w.bgOpacity,1,1):(I.setBgOpacity(1,1,1),I.disableHandles()),Ue(s,0,1))}function be(e,t){O&&(w.bgFade&&!t?F.animate({opacity:1-e},{queue:!1,duration:w.fadeTime}):F.css({opacity:1-e}))}function we(){return F.children()}ve=370,ye={},me={},Ce=!(xe={}),w.dragEdges&&Ze.isArray(w.createDragbars)&&ze(w.createDragbars),Ze.isArray(w.createHandles)&&Oe(w.createHandles),w.drawBorders&&Ze.isArray(w.createBorders)&&Me(w.createBorders),Ze(document).bind("touchstart.jcrop-ios",function(e){Ze(e.currentTarget).hasClass("jcrop-tracker")&&e.stopPropagation()}),Se=N().mousedown(W("move")).css({cursor:"move",position:"absolute",zIndex:360}),x.support&&Se.bind("touchstart.jcrop",x.createDragger("move")),ee.append(Se),Be();var D,ve,ye,me,xe,Ce,Se,I={updateVisible:je,update:He,release:function(){Be(),p.hide(),w.shade?H.opacity(1):De(1),D=!1,w.onRelease.call(P)},refresh:Fe,isAwake:function(){return D},setCursor:function(e){Se.css("cursor",e)},enableHandles:Ie,enableOnly:function(){Ce=!0},showHandles:function(){Ce&&l.show()},disableHandles:Be,animMode:Je,setBgOpacity:De,done:function(){Je(!1),Fe()}};function ke(e,t){t=Ze("<div />").mousedown(W(e)).css({cursor:e+"-resize",position:"absolute",zIndex:t}).addClass("ord-"+e);return x.support&&t.bind("touchstart.jcrop",x.createDragger(e)),l.append(t),t}function ze(e){for(var t=0;t<e.length;t++)xe[e[t]]=ke(e[t],ve++).addClass("jcrop-dragbar")}function Me(e){for(var t,n,o=0;o<e.length;o++){switch(e[o]){case"n":t="hline";break;case"s":t="hline bottom";break;case"e":t="vline right";break;case"w":t="vline"}ye[e[o]]=(n=t,n=Ze("<div />").css({position:"absolute",opacity:w.borderOpacity}).addClass(r(n)),ee.append(n),n)}}function Oe(e){for(var t,n,o=0;o<e.length;o++)me[e[o]]=(t=e[o],n=void 0,n=w.handleSize,t=ke(t,ve++).css({opacity:w.handleOpacity}).addClass(r("handle")),n&&t.width(n).height(n),t)}function Fe(){var e=M.getFixed();M.setPressed([e.x,e.y]),M.setCurrent([e.x2,e.y2]),je()}function je(e){if(D)return He(e)}function He(e){var t,n,o=M.getFixed();t=o.w,n=o.h,p.width(Math.round(t)).height(Math.round(n)),t=o.x,n=o.y,w.shade||d.css({top:i(-n),left:i(-t)}),p.css({top:i(n),left:i(t)}),w.shade&&H.updateRaw(o),D||(p.show(),w.shade?H.opacity(ne):De(ne,!0),D=!0);(e?w.onSelect:w.onChange).call(P,q(o))}function De(e,t,n){(D||t)&&(w.bgFade&&!n?u.animate({opacity:e},{queue:!1,duration:w.fadeTime}):u.css("opacity",e))}function Ie(){if(Ce=!0,w.allowResize)return l.show(),!0}function Be(){Ce=!1,l.hide()}function Je(e){e?($=!0,Be()):($=!1,Ie())}Pe=function(){},Ae=function(){},(Re=w.trackDocument)||b.mousemove(Te).mouseup(Ke).mouseout(Ke),u.before(b);var Pe,Ae,Re,B={activateHandlers:function(e,t,n){return o=!0,Pe=e,Ae=t,e=n,b.css({zIndex:450}),e?Ze(document).bind("touchmove.jcrop",Ee).bind("touchend.jcrop",We):Re&&Ze(document).bind("mousemove.jcrop",Te).bind("mouseup.jcrop",Ke),!1},setCursor:function(e){b.css("cursor",e)}};function Te(e){return Pe(n(e)),!1}function Ke(e){return e.preventDefault(),e.stopPropagation(),o&&(o=!1,Ae(n(e)),I.isAwake()&&w.onSelect.call(P,q(M.getFixed())),b.css({zIndex:290}),Ze(document).unbind(".jcrop"),Pe=function(){},Ae=function(){}),!1}function Ee(e){return Pe(n(x.cfilter(e))),!1}function We(e){return Ke(x.cfilter(e))}J=Ze('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),Ye=Ze("<div />").css({position:"absolute",overflow:"hidden"}).append(J),w.keySupport&&(J.keydown(function(e){if(e.ctrlKey||e.metaKey)return!0;var t=!!e.shiftKey?10:1;switch(e.keyCode){case 37:Le(e,-t,0);break;case 39:Le(e,t,0);break;case 38:Le(e,0,-t);break;case 40:Le(e,0,t);break;case 27:w.allowSelect&&I.release();break;case 9:return!0}return!1}).blur(function(e){J.hide()}),A||!w.fixedSupport?(J.css({position:"absolute",left:"-20px"}),Ye.append(J).insertBefore(u)):J.insertBefore(u));var J,Ye,qe={watchKeys:function(){w.keySupport&&(J.show(),J.focus())}};function Le(e,t,n){w.allowMove&&(M.moveOffset([t,n]),I.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function Xe(e){Ge([e[0]/v,e[1]/y,e[2]/v,e[3]/y]),w.onSelect.call(P,q(M.getFixed())),I.enableHandles()}function Ge(e){M.setPressed([e[0],e[1]]),M.setCurrent([e[2],e[3]]),I.update()}function Ne(){w.disabled=!0,I.disableHandles(),I.setCursor("default"),B.setCursor("default")}function Ve(){w.disabled=!1,Qe()}function Ue(e,t,n){t=t||w.bgColor;w.bgFade&&Ze.fx.step.hasOwnProperty("backgroundColor")&&w.fadeTime&&!n?e.animate({backgroundColor:t},{queue:!1,duration:w.fadeTime}):e.css("backgroundColor",t)}function Qe(e){w.allowResize?e?I.enableOnly():I.enableHandles():I.disableHandles(),B.setCursor(w.allowSelect?"crosshair":"default"),I.setCursor(w.allowMove?"move":"default"),w.hasOwnProperty("trueSize")&&(v=w.trueSize[0]/h,y=w.trueSize[1]/f),w.hasOwnProperty("setSelect")&&(Xe(w.setSelect),I.done(),delete w.setSelect),H.refresh(),w.bgColor!=te&&(Ue(w.shade?H.getShades():s,w.shade&&w.shadeColor||w.bgColor),te=w.bgColor),ne!=w.bgOpacity&&(ne=w.bgOpacity,w.shade?H.refresh():I.setBgOpacity(ne)),V=w.maxSize[0]||0,U=w.maxSize[1]||0,Q=w.minSize[0]||0,Z=w.minSize[1]||0,w.hasOwnProperty("outerImage")&&(u.attr("src",w.outerImage),delete w.outerImage),I.refresh()}x.support&&b.bind("touchstart.jcrop",x.newSelection),l.hide(),Qe(!0);var P={setImage:function(i,r){I.release(),Ne();var a=new Image;a.onload=function(){var e=a.width,t=a.height,n=w.boxWidth,o=w.boxHeight;u.width(e).height(t),u.attr("src",i),d.attr("src",i),Y(u,n,o),h=u.width(),f=u.height(),d.width(h).height(f),b.width(h+2*g).height(f+2*g),s.width(h).height(f),H.resize(h,f),Ve(),"function"==typeof r&&r.call(P)},a.src=i},animateTo:function(e,t){var n,o,i,r,a,s,c,u,d,l,h=e[0]/v,f=e[1]/y,p=e[2]/v,g=e[3]/y;function b(){window.setTimeout(l,i)}$||(e=M.flipCoords(h,f,p,g),n=[(n=M.getFixed()).x,n.y,n.x2,n.y2],o=n,i=w.animationDelay,r=e[0]-n[0],a=e[1]-n[1],s=e[2]-n[2],c=e[3]-n[3],u=0,d=w.swingSpeed,h=o[0],f=o[1],p=o[2],g=o[3],I.animMode(!0),l=function(){u+=(100-u)/d,o[0]=Math.round(h+u/100*r),o[1]=Math.round(f+u/100*a),o[2]=Math.round(p+u/100*s),o[3]=Math.round(g+u/100*c),(u=99.8<=u?100:u)<100?(Ge(o),b()):(I.done(),I.animMode(!1),"function"==typeof t&&t.call(P))},b())},setSelect:Xe,setOptions:function(e){T(e),Qe()},tellSelect:function(){return q(M.getFixed())},tellScaled:function(){return M.getFixed()},setClass:function(e){s.removeClass().addClass(r("holder")).addClass(e)},disable:Ne,enable:Ve,cancel:function(){I.done(),B.activateHandlers(null,null)},release:I.release,destroy:function(){s.remove(),a.show(),a.css("visibility","visible"),Ze(e).removeData("Jcrop")},focus:qe.watchKeys,getBounds:function(){return[h*v,f*y]},getWidgetSize:function(){return[h,f]},getScaleFactor:function(){return[v,y]},getOptions:function(){return w},ui:{holder:s,selection:p}};return R&&s.bind("selectstart",function(){return!1}),a.data("Jcrop",P),P},Ze.fn.Jcrop=function(e,t){var n;return this.each(function(){if(Ze(this).data("Jcrop")){if("api"===e)return Ze(this).data("Jcrop");Ze(this).data("Jcrop").setOptions(e)}else"IMG"==this.tagName?Ze.Jcrop.Loader(this,function(){Ze(this).css({display:"block",visibility:"hidden"}),n=Ze.Jcrop(this,e),Ze.isFunction(t)&&t.call(n)}):(Ze(this).css({display:"block",visibility:"hidden"}),n=Ze.Jcrop(this,e),Ze.isFunction(t)&&t.call(n))}),this},Ze.Jcrop.Loader=function(e,t,n){var o=Ze(e),i=o[0];o.bind("load.jcloader",function e(){i.complete?(o.unbind(".jcloader"),Ze.isFunction(t)&&t.call(i)):window.setTimeout(e,50)}).bind("error.jcloader",function(e){o.unbind(".jcloader"),Ze.isFunction(n)&&n.call(i)}),i.complete&&Ze.isFunction(t)&&(o.unbind(".jcloader"),t.call(i))},Ze.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}});
;/*!wiki-common:widget/component/picUploader/picCropper.js*/
define("wiki-common:widget/component/picUploader/picCropper",function(i,t,o){var h=i("wiki-common:widget/lib/jquery/jquery"),e=(i("wiki-common:widget/ui/picUploader/Jcrop/Jcrop")(h),i("wiki-common:widget/lib/jsmart/jsmart"),i("wiki-common:widget/util/safeCall"),{crop:'<div class="wgt-picCropper-wrapper">\n<img src="{%$picUrl|f_escape_xml%}" />\n</div>\n'});function r(i){!function(i){if(!h(i.container).eq(0).get(0))throw new Error("[PicCropper Exception]: args container is necessary.");if(!i.picUrl)throw new Error("[PicCropper Exception]: args picUrl is necessary.");this.$container=h(i.container).eq(0),this.picUrl=i.picUrl,this.isHiphoto=i.isHiphoto||!0,this.isHiphoto&&(this.isOriginal="pic"==this.picUrl.split("/")[4]),this.boxWidth=i.boxWidth||480,this.boxHeight=i.boxHeight||480,this.originalWidth=i.originalWidth||null,this.originalHeight=i.originalHeight||null,this.cropWidth=i.cropWidth||null,this.cropHeight=i.cropHeight||null,this.selectArr=i.selectArr||null,this.maxSize=i.maxSize||[0,0],this.minSize=i.minSize||[0,0],this.allowSelect=!i.disableNewSelect,this.cropInfo={},this.onRelease=i.onRelease}.call(this,i),function(){var i=h(e.crop.fetch({picUrl:this.picUrl})),t=this,o=(this.$container.append(i),{allowSelect:this.allowSelect,aspectRatio:this.cropWidth/this.cropHeight,boxWidth:this.boxWidth,boxHeight:this.boxHeight,maxSize:this.maxSize,minSize:this.minSize,onRelease:this.onRelease,onChange:function(i){t.cropInfo={x1:Math.round(i.x),x2:Math.round(i.x2),y1:Math.round(i.y),y2:Math.round(i.y2),width:Math.round(i.w),height:Math.round(i.h)}}});this.selectArr&&4===this.selectArr.length&&(o=h.extend(o,{setSelect:this.selectArr})),i.find("img").Jcrop(o)}.call(this)}r.prototype={constructor:r,getcropInfo:function(){return!(!this.cropInfo.width||!this.cropInfo.height)&&this.cropInfo},getHiphotoFeature:function(){if(!this.cropInfo.width||!this.cropInfo.height||!this.isHiphoto||this.isHiphoto&&this.isOriginal&&(!this.originalWidth||!this.originalHeight))return!1;var i,t,o,e=[0<=this.cropInfo.x1?this.cropInfo.x1:0,0<=this.cropInfo.y1?this.cropInfo.y1:0,this.cropInfo.width,this.cropInfo.height];return this.originalWidth&&this.originalHeight&&(i=this.$container.find("img").eq(0).width()/this.originalWidth,t=this.$container.find("img").eq(0).height()/this.originalHeight,o=i<t?i:t,h.each(e,function(i,t){e[i]=Math.round(t/o)})),"crop="+e.join(",")+";eWH="+this.cropWidth+","+this.cropHeight}},o.exports=r});
;/*!wiki-common:widget/component/picUploader/picUploader.js*/
define("wiki-common:widget/component/picUploader/picUploader",function(e,i,t){var a=e("wiki-common:widget/lib/jquery/jquery"),p=e("wiki-common:widget/lib/jsmart/jsmart"),n=e("wiki-common:widget/util/safeCall"),r=(p.prototype.registerPlugin("modifier","join",function(e,i){return e.join(i)}),{form:'<div class="wgt-picUploader-wrapper">\n<form class="wgt-picUploader-form" method="post" enctype="multipart/form-data">\n<input type="file" name="file" accept="{%$allowMimeTypes|join:\',\'|f_escape_xml%}">\n</form>\n</div>'}),o="/api/common/uploadimage",s={1001:"ERR_PIC_UPLOAD_FAILED",2001:"FILE_INVALID_PARAMETER",2002:"FILE_NO_FILE",2003:"FILE_SIZE_LIMIT_EXCEEDED",2004:"FILE_TYPE_UNSUPPORTED",2005:"FILE_TMP_NOT_FOUND",2099:"FILE_UNKNOWN_ERROR"},l=["image/jpeg","image/pjpeg","image/png","image/x-png","image/gif","image/webp","application/octet-stream"];function c(e){!function(e){var t;this.url=e.url||o,this.sensitive=e.sensitive||!1,this.status=e.status||!1,this.allowMimeTypes=(t=[],t=e.allowTypes?(a.each(e.allowTypes,function(e,i){switch(i){case"jpg":t=t.concat(["image/jpeg","image/pjpeg"]);break;case"png":t=t.concat(["image/png","image/x-png"]);break;case"gif":t=t.concat(["image/gif"]);break;case"webp":t=t.concat(["image/webp"])}}),t.concat(["application/octet-stream"])):[].concat(l)),this.previewWidth=parseInt(e.previewWidth)||null,this.previewHeight=parseInt(e.previewHeight)||null,this.maxSize=parseInt(e.maxSize,10)||10,this.$uploadBtn=a(e.uploadBtn),this.beforeUpload=e.beforeUpload,this.onUploadSuccess=e.onUploadSuccess,this.onUploadError=e.onUploadError,this.onUploadComplete=e.onUploadComplete,this.picInfo=null}.call(this,e),function(){var e=a(r.form.fetch({allowMimeTypes:this.allowMimeTypes})),o=("static"==this.$uploadBtn.css("position")&&this.$uploadBtn.css("position","relative"),e.css("z-index",(parseInt(this.$uploadBtn.css("z-index"))||1)+1),this.$uploadBtn.append(e),this);this.$uploadBtn.find('[type="file"]').on("change",function(){var t,p;o.picInfo=null,this.files[0].size/1048576>o.maxSize?n(o.onUploadError,{errno:413,errmsg:"图片大小不超过"+o.maxSize+"M"},o):a.trim(a(this).val())&&((t=new FormData).append("file",this.files[0]),t.append("maxSize",o.maxSize),t.append("allowMimeTypes",o.allowMimeTypes),t.append("sensitive",o.sensitive?1:0),t.append("status",o.status?1:0),o.previewWidth&&t.append("previewWidth",o.previewWidth),o.previewHeight&&t.append("previewHeight",o.previewHeight),p=this,n(o.beforeUpload,null,o),a.ajax({type:"POST",url:o.url,data:t,cache:!1,processData:!1,contentType:!1,success:function(e){var i;(e=e||{errno:1001}).errno?(i=s[e.errno]||"UNKNOWN_ERROR",n(o.onUploadError,{errno:e.errno,errmsg:i},o)):(o.picInfo={picId:e.picId,picUrl:e.picUrl,picSrc:e.picSrc||null,requestSign:e.requestSign||null,typeName:e.typeName,previewUrl:e.previewUrl,previewWidth:e.previewWidth,previewHeight:e.previewHeight,width:e.width,height:e.height},n(o.onUploadSuccess,o.picInfo,o))},error:function(e){n(o.onUploadError,{errno:425,errmsg:e.statusText||"请求发送失败"},o)},complete:function(e,i){a(p).val(""),t=null,n(o.onUploadComplete,{xhr:e,ts:i},o)}}))})}.call(this)}c.prototype={constructor:c,getPicInfo:function(){return this.picInfo}},t.exports=c});
;/*!wiki-common:widget/component/recommendLemmas/fetchData.es.js*/
define("wiki-common:widget/component/recommendLemmas/fetchData.es",function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function u(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function p(){p=function(e,t){return new n(e,void 0,t)};var o=RegExp.prototype,c=new WeakMap;function n(e,t,r){t=new RegExp(e,t);return c.set(t,r||c.get(e)),m(t,n.prototype)}function a(r,e){var n=c.get(e);return Object.keys(n).reduce(function(e,t){return e[t]=r[n[t]],e},Object.create(null))}var e=n,t=RegExp;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t),n.prototype.exec=function(e){e=o.exec.call(this,e);return e&&(e.groups=a(e,this)),e},n.prototype[Symbol.replace]=function(e,t){var r,n;return"string"==typeof t?(r=c.get(this),o[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+r[t]}))):"function"==typeof t?(n=this,o[Symbol.replace].call(this,e,function(){var e=arguments;return"object"!=i(e[e.length-1])&&(e=[].slice.call(e)).push(a(e,n)),t.apply(this,e)})):o[Symbol.replace].call(this,e,t)},p.apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getHotLemma=function(e,t){l?e&&e(l):(f.push(e),s.push(t),y||(y=!0,n.ajax({type:"GET",url:"/api/wikihome/homecmsdata",dataType:"json",success:function(e){e&&0===e.errno&&e.data&&e.data.hotLemmas&&e.data.hotLemmas.today&&e.data.hotLemmas.today.length&&(l=e.data.hotLemmas.today.map(function(e,t){return u(u({},e),{},{recommendType:"HOT_LEMMAS",recommendTitle:"热搜：".concat(e.title),recommendUrl:e.url,queryTitle:e.title,recommendIndex:t,recommendLemmaId:e.lemmaInfo&&e.lemmaInfo.lemmaId?e.lemmaInfo.lemmaId:void 0})}))},error:function(){a(s)},complete:function(){y=!1,l&&a(f,l)}})))},t.getTihData=function(e){b?e&&e(b):(d.push(e),h||(h=!0,n.ajax({type:"GET",url:"https://baikebcs.cdn.bcebos.com/cms/home/eventsOnHistory/".concat(O,".json"),cache:!1,dataType:"json",success:function(e){b=o(e,O,g)},error:function(){a(d,[])},complete:function(){h=!1,b&&a(d,b)}})))};var n=e("wiki-common:widget/lib/jquery/jquery"),t=e("wiki-common:packages/utils/datetime"),o=function(e,t,r){var n,o=[],c=e[t];for(n in c){var a=c[n];n.substring(2,4)===r&&(o=a)}return(o||[]).filter(function(e){return e.recommend}).sort(function(e,t){e=e.year,t=t.year;return parseInt(t,10)-parseInt(e,10)}).map(function(e,t){e.title.match(p(/<a.*?>(.*?)<\/a>/,{name:1}));var r=RegExp.$1;return u(u({},e),{},{recommendUrl:e.title.match(/href="(.*)">/)[1],recommendTitle:"历史上的今天：".concat(e.year,"年").concat(e.title.replace(/<[^>]+>/g,"")),recommendType:"HISTORY",queryTitle:r,recommendIndex:t})})};function a(e,t){e.forEach(function(e){"function"==typeof e&&e("object"===i(t)?JSON.parse(JSON.stringify(t)):t)})}var l=null,f=[],s=[],y=!1;var b=null,d=[],h=!1,O=t.formatDate(Date.now(),"MM"),g=t.formatDate(Date.now(),"dd")});
;/*!wiki-common:widget/component/recommendLemmas/recommendLemmas.es.js*/
define("wiki-common:widget/component/recommendLemmas/recommendLemmas.es",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=e("wiki-common:widget/component/recommendLemmas/fetchData.es");function a(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function s(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach(function(e){var t,n;t=r,n=i[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function c(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("wiki-common:widget/lib/jquery/jquery"),h=e("wiki-common:packages/utils/storage"),u=e("wiki-common:widget/tools/logUtils.es"),m=e("wiki-common:widget/component/evtMsgManager/evtMsgManager.es"),e=i("#J-vars"),d={lemmaId:e.data("lemmaid"),lemmaTitle:e.data("lemmatitle")},f=8,v="BK_DEL_RECOMMEND_LEMMAS",g="BK_CURRENT_RECOMMEND_LEMMA_INDEX",y={HISTORY:"HISTORY",HOTLEMMAS:"HOT_LEMMAS"},w=1e4,p=500,i=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");if(!e)throw Error("props must be required");this.wholeData=e.wholeData&&e.wholeData.length?e.wholeData:[],this.$el=e.$el||null,this.key=e.key||v,this.$searchbar=e.$searchbar,this.initParams()}var e,n,r,i;function a(){return i.apply(this,arguments)}return e=t,(n=[{key:"initParams",value:function(){this.isMainSearchBar=this.$searchbar.hasClass("wgt-searchbar-main"),this.$query=this.$searchbar.find("#query"),this.isActiveElement=this.$query[0]==document.activeElement,this.searchBarName=this.$query.data("type"),this.placeHolderStringNum=Math.floor((this.$searchbar.find(".J-input-wrap").width()-10)/16),this.timer=null,this.queryedData=this.getQueryedLemmas(),this.currentLemma=null,this.showArr=[],this.bindEvent(),this.fetchData()}},{key:"bindEvent",value:function(){var t=this;m.on("offAllInterval",function(e){e!==t.searchBarName&&t.clearInterval()}),m.on("reRender",function(e){e!==t.searchBarName&&t.render(!1)}),window.onbeforeunload=function(){h.set(g,JSON.stringify(t.currentIndex))},window.removeEventListener("scroll",this.dataShowLog.bind(this)),window.addEventListener("scroll",this.dataShowLog.bind(this))}},{key:"emitReRender",value:function(){m.emit("reRender",this.searchBarName)}},{key:"requestTihData",value:function(){var t=this;(0,o.getTihData)(function(e){t.addWholeData(e),t.initData(),t.render()})}},{key:"initData",value:function(){this.currentIndex=this.getCurrentIndex()}},{key:"removeShowIn",value:function(){var e=this;this.timerLock||this.isActiveElement||(this.showInTimer=setTimeout(function(){e.$el.removeClass("show-in")},w-p))}},{key:"render",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.preCheck()&&(t?this.changeAttr():(this.timerLock=!1,this.removeShowIn()),this.timerLock||(this.isActiveElement?this.stopRun():this.timer=setInterval(function(){e.setCurrentIndex(),e.changeAttr()},w)))}},{key:"preCheck",value:function(){return!this.wholeData.length||this.getRecommendData().length<2?(this.getRecommendData().length&&this.changeAttr(),this.clearInterval(),!1):null!=this.currentIndex||(this.clearInterval(),!1)}},{key:"changeAttr",value:function(){var e=this.getRecommendData()[this.currentIndex];this.$el.text(e.recommendTitle),this.removeShowIn(),this.$el.addClass("show-in"),this.dataShowLog()}},{key:"addWholeData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.wholeData=[].concat(c(this.wholeData),c(e)).map(function(e,t){return s({index:t},e)})}},{key:"setQueryedLemma",value:function(e){h.set(v,JSON.stringify([].concat(c(this.getQueryedLemmas()),[e]))),h.set(g,JSON.stringify(this.currentIndex))}},{key:"getQueryedLemmas",value:function(){return h.get(v)||[]}},{key:"getRecommendData",value:function(){var e=this;return this.wholeData.filter(function(t){return e.queryedData.every(function(e){return t.recommendTitle!==e.recommendTitle&&t.recommendUrl!==e.recommendUrl})})}},{key:"setCurrentIndex",value:function(){this.currentIndex=this.currentIndex===this.getRecommendData().length-1?0:this.currentIndex+1}},{key:"getCurrentIndex",value:function(){var e=Number.parseInt(h.get(g),10)||0;return e>=this.getRecommendData().length||0===e?0:e}},{key:"handleRecommendTitle",value:function(e){var n=this;return e.map(function(e){var t=e.recommendTitle;return s(s({},e),{},{recommendTitle:t.length>n.placeHolderStringNum?"".concat(t.slice(0,n.placeHolderStringNum-1),"..."):t})})}},{key:"fetchData",value:function(){var t=this;(0,o.getHotLemma)(function(e){e=e.slice(0,f);t.addWholeData(e),t.requestTihData()},function(){t.requestTihData()})}},{key:"clearInterval",value:(i=function(){this.timer||this.showInTimer?(clearInterval(this.timer),clearTimeout(this.showInTimer),!this.$el.hasClass("show-in")&&this.$el.text()&&this.$el.addClass("show-in")):this.timerLock=!0},a.toString=function(){return i.toString()},a)},{key:"clearAllInterval",value:function(){m.emit("offAllInterval",this.searchBarName),this.clearInterval()}},{key:"stopRun",value:function(){var e=this;!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?this.clearAllInterval():setTimeout(function(){e.clearAllInterval()},w)}},{key:"getLogParams",value:function(e){return e=e||this.getShowData(),s(s({},d),{},{index:e.recommendIndex,recommendLemmaId:e.recommendLemmaId,queryTitle:e.queryTitle})}},{key:"getShowData",value:function(){try{return this.getRecommendData()[this.currentIndex]}catch(e){return null}}},{key:"dataShowLog",value:function(){var t;!function(e){if(!e||!e.length)return!1;var e=e[0].getBoundingClientRect(),t=e.top,e=e.bottom;return 0<t&&t<window.innerHeight||0<e&&e<window.innerHeight}(this.$searchbar)||(t=this.getShowData())&&!this.showArr.some(function(e){return e.recommendTitle===t.recommendTitle&&e.recommendUrl===t.recommendUrl})&&(this.showArr.push(t),u.logViewEl("".concat(this.isMainSearchBar?"":"top-","search-").concat(t.recommendType===y.HISTORY?"tih":"hot"),this.getLogParams()))}},{key:"clickLog",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=(r=3<arguments.length?arguments[3]:void 0)||this.getShowData();u.logActClick("".concat(r.recommendType===y.HOTLEMMAS?"hot":"tih").concat("search-bar"===e?"":"-top","-search-").concat("enter"===n?"return":"searchLemma"===t?"all":"inlemma"),this.getLogParams(r))}}])&&l(e.prototype,n),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.default=i,n.exports=t.default});
;/*!wiki-common:widget/component/recruitment/recruitment.js*/
define("wiki-common:widget/component/recruitment/recruitment",function(n,o,e){"use strict";try{window.console&&window.console.log&&window.console.log("## 百度百科招聘Web前端研发工程师 ##\n\n对百度百科的技术感兴趣？不如加入我们，一起来创造她吧！\n\n百度百科是百度公司推出的一部内容开放、自由的网络百科全书平台，于2006年4月上线，至今已有12余年的技术积累。\n百度百科产品形态以Web为主，在这里你可以接触到前沿的技术、海量的数据、完善的人才成长机制，与一群热情活跃的小伙伴们一起工作和学习。\n\n职位详情及简历投递入口： https://dwz.cn/n1ed7AVN")}catch(n){}});
;/*!wiki-common:widget/component/searchbar-n/searchbar.js*/
define("wiki-common:widget/component/searchbar-n/searchbar",function(e,i,t){"use strict";function d(){var e=$;return-1<window.location.pathname.indexOf("/search")&&(e=_),e=-1<window.location.pathname.indexOf("/personal/question")||-1<window.location.pathname.indexOf("/wikiui/Main/referencepic")?L:e}var m=e("wiki-common:widget/lib/jquery/jquery"),u=e("wiki-common:widget/util/browser"),n=e("wiki-common:widget/util/cookie"),f=e("wiki-common:widget/tools/logUtils.es"),s=e("wiki-common:widget/lib/jsmart/jsmart"),p=void 0,o=e("wiki-common:widget/util/getBaiduId"),y=e("wiki-common:widget/component/recommendLemmas/fetchData.es").getHotLemma,v=e("wiki-common:node_modules/entities/lib/index").encodeHTML,o=o(),b=25<=o&&o<75,k=25<=o&&o<75,w=(b&&(p=e("wiki-common:widget/component/recommendLemmas/recommendLemmas.es")),new s('{%if $list|count%}\n<li class="history-box J-history-box {%if $hotRightList|count%} large-margin{%/if%}">\n<div class="list-title">\n<img class="title-icon" src="https://baikebcs.bdimg.com/front-end/common/searchbar/history-title-2.png">\n<div class="del-all-btn" id="clear-history">删除全部</div>\n</div>\n<div class="history-list">\n{%foreach $list as $item%}<div class="history-item J-history-item" data-word="{%$item|escape:html|f_escape_xml%}">\n<div class="history-content">{%$item|f_escape_xml%}</div>\n<div class="clear-btn J-delete"><em class="cmn-icon cmn-icons cmn-icons_clear"></em></div>\n</div>{%/foreach%}\n</div>\n</li>\n{%/if%}\n{%if $hotRightList|count && !$isSearchHotBlack%}\n<li class="hot-box">\n<div class="list-title">\n<img class="title-icon" src="https://baikebcs.bdimg.com/front-end/common/searchbar/hot-title-2.png">\n</div>\n<div class="hot-list">\n<div class="hot-right-list">\n{%foreach $hotRightList as $index => $item%}\n<div class="hot-item J-hot-item" data-index="{%$index|f_escape_xml%}">\n{%if $index < 3%}\n<img src="https://baikebcs.bdimg.com/front-end/common/searchbar/index-{%$index|f_escape_path%}.png" class="hot-index hot-index-img">\n{%else%}\n<div class="hot-index">\n{%$index + 1%}\n</div>\n{%/if%}\n<div class="hot-lemma">\n<div class="hot-lemma-title">{%$item.title|f_escape_xml%}</div>\n<div class="hot-lemma-desc">{%$item.wapAbstract|f_escape_xml%}</div>\n</div>\n</div>\n{%/foreach%}\n</div>\n<div class="hot-left-list">\n{%foreach $hotLeftList as $index => $item%}\n<div class="hot-item J-hot-item" data-index="{%$index + $hotRightList|count%}">\n{%if $index + $hotRightList|count < 3%}\n<img src="https://baikebcs.bdimg.com/front-end/common/searchbar/index-{%$index + $hotRightList|count%}.png" class="hot-index hot-index-img">\n{%else%}\n<div class="hot-index">\n{%$index + 1 + $hotRightList|count%}\n</div>\n{%/if%}\n<div class="hot-lemma">\n<div class="hot-lemma-title">{%$item.title|f_escape_xml%}</div>\n<div class="hot-lemma-desc">{%$item.wapAbstract|f_escape_xml%}</div>\n</div>\n</div>\n{%/foreach%}\n</div>\n</div>\n</li>\n{%/if%}')),x=new s('{%if $list|count%}\n<li class="sug-lemma{%if $recommendList|count == 0%} large-margin{%/if%}">\n{%foreach $list as $item%}\n<div class="sug-lemma_item J-sug-item" data-word="{%$item.lemmaTitle|escape:html|f_escape_xml%}" data-lemmaid="{%$item.lemmaId|f_escape_xml%}">\n<img class="sug-summary" src="{%if $item.abstractPic%}{%$item.abstractPic|f_escape_path%}{%else%}https://baikebcs.bdimg.com/front-end/common/searchbar/lemma-default.png{%/if%}">\n<div class="sug-lemma_item-content">\n<div class="sug-lemma_item-content-title">{%$item.lemmaTitle|f_escape_xml%}</div>\n{%if $item.lemmaDesc%}\n<div class="sug-lemma_item-content-desc">{%$item.lemmaDesc|f_escape_xml%}</div>\n{%/if%}\n</div>\n</div>\n{%/foreach%}\n<div class="sug-lemma_more J-sug-item-more" data-word="{%$query|escape:html|f_escape_xml%}">查看&nbsp;<span class="sug-lemma_query">{%$query|f_escape_xml%}</span>&nbsp;的全部搜索结果<em class="cmn-icon cmn-icons cmn-icons_arrow-r-3"></em></div>\n</li>\n{%/if%}\n{%if $list|count && $recommendList|count%}\n<li class="line-split"></li>\n{%/if%}\n{%if $recommendList|count%}\n<li class="sug-recommend">\n<div class="sug-recommend_title">\n猜你想搜</div>\n{%foreach $recommendList as $item%}\n<div class="sug-recommend_item J-sug-item" data-sug-type="guess" data-base-index="{%$list|count - 1%}" data-word="{%$item|escape:html|f_escape_xml%}">\n<em class="cmn-icon cmn-icons cmn-icons_search-new"></em>{%$item|f_escape_xml%}\n</div>\n{%/foreach%}\n</li>\n{%/if%}'),_="search-result",$="lemma",L="personal-ref";function q(e){e.find(".J-input-clear").off("click").addClass("hidden")}function a(e){e.find(".J-input-clear").removeClass("hidden").on("click",function(e){e.find("#query").val("").focus(),q(e),A(e),e.trigger("searchbar:input")}.bind(this,e))}function J(e){b&&e.$fakePlaceholder.addClass("hidden")}function A(e){b&&e.$fakePlaceholder.removeClass("hidden")}function H(e){a(e),J(e)}function C(e){q(e),A(e)}r.prototype.getAsyncHistory=function(i){var t=this;m.ajax({type:"GET",url:"/api/searchui/gethistory",data:{limit:this.maxLength,t:Date.now()},cache:!1}).then(function(e){t.isLogin=e.isLogin,e.isLogin?t.historyArray=e.list:t.__parseHistoryFromCookie(),i(t.historyArray)})},r.prototype.clearHistory=function(e){this.isLogin?m.ajax({type:"GET",url:"/api/searchui/clearhistory",data:{},cache:!1}).then(function(){}):(n.remove(this.key,{path:"/"}),this.__parseHistoryFromCookie())},r.prototype.deletehistory=function(t){var s=this;if(this.isLogin)m.ajax({type:"GET",url:"/api/searchui/deletehistory",data:{word:t},cache:!1}).then(function(e){if(0===e.errno)for(var i=0;i<s.historyArray.length;i++)s.historyArray[i].toString()===t.toString()&&s.historyArray.splice(i,1)});else{s.__parseHistoryFromCookie();for(var e=0;e<s.historyArray.length;e++)s.historyArray[e].toString()===t.toString()&&s.historyArray.splice(e,1);n.set(s.key,JSON.stringify({key:s.historyArray}),{expires:31536e6,path:"/"})}},r.prototype.__parseHistoryFromCookie=function(){try{var e=JSON.parse(n.get(this.key));this.historyArray=e.key}catch(e){this.historyArray=[]}},r.prototype.__utilUnique=function(e){for(var i=[],t=0,s=e.length;t<s;t++){for(var n=0,o=i.length;n<o&&e[t]!==i[n];n++);n===o&&e[t].length&&i.push(e[t])}return i},r.prototype.setHistoryItem=function(e){var i=this;this.isLogin||(i.__parseHistoryFromCookie(),e.length&&i.historyArray.unshift(e),i.historyArray=i.__utilUnique(i.historyArray),i.historyArray=i.historyArray.slice(0,i.maxLength),n.set(i.key,JSON.stringify({key:i.historyArray}),{expires:31536e6,path:"/"}))};var S=r;function r(e){this.isLogin=!1,this.key="BK_SEARCHLOG",this.historyArray=[],this.maxLength=k?10:20}t.exports=function(s,a){var r=new S,c=void 0,e=(s.$fakePlaceholder=void 0,d()),t=(a=a||-1<[_,L].indexOf(e),(b=a?!1:b)&&((e=s).find(".J-fake-placeholder").remove(),e.find(".J-input-wrap").append('<span class="J-fake-placeholder fake-placeholder"></span>'),s.$fakePlaceholder=s.find(".J-fake-placeholder"),s.$fakePlaceholder.css({"line-height":s.find("#query").height()+12+"px"}),c=new p({$searchbar:s,$el:s.$fakePlaceholder}),s.recommendLemmas=c),""),i="",l=[],h=(k&&y(function(e){l=e.splice(0,10)}),{selected:0,isHistory:0,list:[],suggest:[],searchInOtherProducts:function(e,i,t){e=m.trim(e.find("#query").val());location.href=e?i+encodeURIComponent(e):t},requestSuggestion:function(e){e&&""!=m.trim(e)?(this.isHistory=0,m.ajax({url:"https://www.baidu.com/sugrec?wd="+encodeURIComponent(e)+"&prod=open_baike&cb=window.baidu.sug&oe=gb18030",dataType:"script",scriptCharset:"GBK"})):(this.isHistory=1,r.getAsyncHistory(function(e){window.baidu.sug({q:"",g:e,isHistory:1})}))},renderSuggestion:function(e,i){if(!k&&h.list.length<=0||k&&(this.isHistory&&l.length<=0&&h.list.length<=0||!this.isHistory&&h.list.length<=0&&h.suggest.length<0))e.find("#suggestion").hide();else{if(k){var t;1===this.isHistory?(t=Math.ceil(l.length/2),e.find("#suggestion").empty().append(w.fetch({list:h.list.slice(0,10),hotRightList:l.slice(0,t),hotLeftList:l.slice(t),isSearchHotBlack:a})),l.length&&f.logViewEl("his-hot",{},d()),h.list.length&&f.logViewEl("his-his",{},d())):(e.find("#suggestion").empty().append(x.fetch({list:h.suggest||[],query:i,recommendList:h.list||[]})),e.find("#suggestion .J-sug-item .sug-summary").on("error",function(){m(this).attr("src","https://baikebcs.bdimg.com/front-end/common/searchbar/lemma-default.png")}),h.suggest.length&&f.logViewEl("sug-polysemant",{},d()),h.list.length&&f.logViewEl("sug-guess",{},d()))}else{5<h.list.length?e.find("#suggestion").addClass("sugbg"):e.find("#suggestion").removeClass("sugbg"),e.find("#suggestion").removeClass("isHistory"),this.isHistory&&e.find("#suggestion").addClass("isHistory");for(var s,n="",o=0;o<h.list.length;o++)this.isHistory?(s=h.list[o],n+='<li><span class="history__item">'+(s=v(s))+'</span><span class="J-delete delete" data-word="'+s+'">删除</span></li>'):h.list[o].match(h.list[0])?n+='<li class="matched">'+h.list[o].replace(h.list[0],'<span class="highlight">'+h.list[0]+"</span>")+"</li>":n+="<li>"+h.list[o]+"</li>";e.find("#suggestion > div").empty().append(m(n))}f.logViewEl(this.isHistory?"his":"sug",{},d()),e.find("#suggestion").width(e.find(".input-wrap").width()-2),e.find("#suggestion").show()}h.selected=0},hoverSuggestion:function(e){var i=k?".J-history-item":"div li",t=h.list;0<(t=k&&!h.isHistory?h.list.concat((i=".J-sug-item").suggest):t).length?(e.find("#suggestion "+i).removeClass("selected"),0<=h.selected-1&&e.find("#suggestion "+i).eq(h.selected-1).addClass("selected")):h.requestSuggestion(m.trim(e.find("#query").val()))},selectSuggestion:function(e){var i=h.getSelectedItem(e);i&&(h.isHistory&&e.find("#J-fromModule").val("lemma_search-history"),e.find("#query").val(k?i.data("word"):h.list[h.selected-1]),H(s))},getSelectedItem:function(e){var i=k?".J-history-item":"div li",t=h.list;return 0<(t=k&&!h.isHistory?h.list.concat((i=".J-sug-item").suggest):t).length&&(t=e.find("#suggestion "+i+".selected")).length?t:null},closeSuggestion:function(e){h.selected=0,h.list=[];var i=e.find("#suggestion");(k?i:e.find("#suggestion > div")).empty(),i.hide()},input:function(e){clearTimeout(t);var i=m.trim(e.find("#query").val());t=setTimeout(function(){h.requestSuggestion(i)},200)},handleSearch:function(e,i,t,s){var n,o=e.find("#query"),a=o.val();return""==a&&(!c||null==(n=c.getShowData())?a="百度百科":(a=n.queryTitle,c.setQueryedLemma(n),c.clickLog(e.find("#query").data("type"),i,t),c.stopRun())),k&&(n=e.find("#J-lemma-id"),(i=h.getSelectedItem(e))&&i.data("lemmaid")?n.val(i.data("lemmaid")):n.val("")),r.setHistoryItem(a),o.val(a),c&&J(s),a},search:function(e,i){h.handleSearch(e,"search",i,s),e.find("#searchForm").submit(),h.closeSuggestion(e)},searchLemma:function(e){var i=h.handleSearch(e,"searchLemma","",s);e.find("#searchLemmaQuery").val(i),e.find("#searchLemmaForm").submit()}});function n(i){window.baidu=window.baidu||{},window.baidu.sug=function(e){h.getRecommendAjax&&h.getRecommendAjax.abort(),h.list=e.isHistory?k?e.g.slice(0,10):e.g:function(e){if(!e)return[];var i=[];return e.forEach(function(e){i.push(e.q)}),i}(e.g),!e.isHistory&&k?h.getRecommendAjax=m.ajax({url:"/api/searchui/suggest",data:{wd:e.q,enc:"utf8"},success:function(e){0===e.errno&&(h.suggest=e.list.slice(0,5),h.list=h.list.slice(0,10-e.list.length))},complete:function(){h.renderSuggestion(i,e.q)}}):h.renderSuggestion(i,e.q)}}s.on("searchInOtherProducts",function(e,i){var t=i.attr("data-href"),i=i.attr("href");t&&i&&h.searchInOtherProducts(m(this),t,i)}),s.on("suggestion:shiftUp",function(){var e=h.list.length+(h.isHistory||!k?0:h.suggest.length);h.selected=h.selected-1<=0?e:h.selected-1,h.hoverSuggestion(m(this)),h.selectSuggestion(m(this))}),s.on("suggestion:shiftDown",function(){var e=h.list.length+(h.isHistory||!k?0:h.suggest.length);h.selected=h.selected+1>e?1:h.selected+1,h.hoverSuggestion(m(this)),h.selectSuggestion(m(this))}),s.on("suggestion:hover",function(e,i){h.selected=i.index()+(i.data("baseIndex")||0)+1,h.hoverSuggestion(m(this))}),s.on("suggestion:leave",function(){h.selected=0,h.hoverSuggestion(m(this))}),s.on("suggestion:close",function(){h.closeSuggestion(m(this))}),s.on("suggestion:select",function(){h.selectSuggestion(m(this))}),s.on("searchbar:focus",function(){clearTimeout(i),c&&((m.trim(s.find("#query").val())?H:A)(s),c.stopRun()),i=setTimeout(function(){m.trim(s.find("#query").val())||f.logActClick("search-bar-real",{},d())},200),n(m(this))}),s.on("searchbar:input",function(){n(m(this)),h.input(m(this))}),s.on("searchbar:search",function(e,i){h.search(m(this),i)}),s.on("searchbar:searchLemma",function(){h.searchLemma(m(this))}),s.find(".search .nav a").on("click",function(e){return m(this).trigger("searchInOtherProducts",[m(this)]),!1});var o,g=!1;s.find("#query").on("keydown",function(e){switch(e.keyCode){case 38:m(this).trigger("suggestion:shiftUp"),e.preventDefault();break;case 40:m(this).trigger("suggestion:shiftDown"),e.preventDefault();break;case 9:case 27:m(this).trigger("suggestion:close");break;case 13:f.logActClick("search-return"),m(this).trigger("searchbar:search","enter"),e.preventDefault()}}).on("compositionend",function(e){g=!1,m(this).trigger("searchbar:input")}).on("compositionstart",function(e){g=!0}).on("focus",function(){f.logActClick(m(this).data("type"),{},d()),m(this).trigger("searchbar:focus")}).on("blur",function(){c&&(s.find("#query").val()?(setTimeout(function(){q(s)},200),J(s)):(C(s),c.render(!1),c.emitReRender()))}).on("keyup",function(e){g||(48<=(e=e.keyCode)&&e<=57||65<=e&&e<=90||186<=e&&e<=192||8==e||32==e||220==e)&&m(this).trigger("searchbar:input")}),s.find("#query").on("input",function(){(m(this).val()?H:C)(s)}),s.find("#query").on("click",function(e){0===m.trim(m(this).val()).length&&m(this).trigger("searchbar:input")}),(e=k?s.find("#suggestion"):s.find("#suggestion div")).on("mouseover",k?".J-history-item,.J-sug-item":"li",function(e){m(this).trigger("suggestion:hover",[m(this)])}),e.on("mouseleave",k?".J-history-item,.J-sug-item":"li",function(e){m(this).trigger("suggestion:leave")}),e.on("click",k?".J-history-item":"li",function(e){var i=m(e.target),t=i.hasClass("J-delete")||i.parents(".J-delete").length;if(t||f.logActClick(k||h.isHistory?"his-lemma":"sug-lemma",{index:m(this).index(),type:m(this).parents("#suggestion").data("type")},d()),t)return r.deletehistory((k?m(this):i).data("word")),void(k?(1<i.parents("#suggestion").find(".J-history-item").length?m(this):s.find(".J-history-box")).remove():(2<i.parents("#suggestion").find("li").length&&e.stopPropagation(),m(this).remove()));m(this).trigger("suggestion:select"),m(this).trigger("searchbar:search")}),k&&(s.find("#suggestion").on("click",".J-hot-item",function(e){var i=m(this),i=Number(i.data("index")),i=l[i];b&&c&&(c.setQueryedLemma(i),c.clickLog(s.find("#query").data("type"),"search","",i),c.stopRun(),J(s)),s.find("#query").val(i.queryTitle),f.logActClick("his-hot",{lemmaId:i.lemmaId,lemmaTitle:i.lemmaTitle},d()),m(this).trigger("searchbar:search")}),s.find("#suggestion").on("click",".J-sug-item",function(e){var i=m(this).data("sugType");f.logActClick("guess"===i?"sug-guess":"sug-polysemant",{index:m(this).index(),type:m(this).parents("#suggestion").data("type"),word:m(this).data("word")},d()),m(this).trigger("suggestion:select"),m(this).trigger("searchbar:search")}),s.find("#suggestion").on("click",".J-sug-item-more",function(e){f.logActClick("sug-all",{query:s.find("#query").val(),type:m(this).parents("#suggestion").data("type")},d()),m(this).trigger("searchbar:searchLemma")})),s.find("#suggestion #close").on("click",function(){var e=m(this).parents(".suggestion").hasClass("isHistory");f.logActClick(e?"his-close":"sug-close",{type:m(this).data("type")},d()),m(this).trigger("suggestion:close")}),s.find("#suggestion").on("click","#clear, #clear-history",function(){f.logActClick("his-clear-all",{type:m(this).data("type")},d()),r.clearHistory(),k&&s.find(".J-history-box").remove()}),s.find("#search").on("click",function(){f.logActClick(m(this).data("type"),{},d()),m(this).trigger("searchbar:search")}),s.find("#searchLemma").on("click",function(){f.logActClick("search-all",{},d()),m(this).trigger("searchbar:searchLemma")}),s.find(".J-help").on("click",function(){f.logActClick("search-help")}),m("*").on("click",function(e){var i=m(this).parents(".wgt-searchbar")===s;(i=k?m(this)[0]===s.find("#suggestion")[0]||m(this).parents(".search")[0]===s.find(".search")[0]:i)?e.stopPropagation():s.trigger("suggestion:close")}),o=s.find("#query").data("value"),u.ipad()||s.each(function(){var e;0<m(this).parents(".header-wrapper").length?(b?(e=o,m(this).find("#query").val(e).focus(),e&&(J(s),c.stopRun())):(m(this).find("#query").val("").focus().val(o),m(".wgt-searchbar-simple").find("#query").val("").focus().val(o)),n(m(this))):b&&d()===$&&(J(s),m(this).find("#query").val(o).focus(),c.stopRun())})}});
;/*!wiki-common:widget/component/searchbar/searchbar.js*/
define("wiki-common:widget/component/searchbar/searchbar",function(e,t,i){"use strict";var r=e("wiki-common:widget/lib/jquery/jquery"),o=e("wiki-common:widget/util/browser");i.exports=function(t){var e,i="",s={selected:0,list:[],searchInOtherProducts:function(e,t,i){e=r.trim(e.find("#query").val());location.href=e?t+encodeURIComponent(e):i},requestSuggestion:function(e){e&&""!==r.trim(e)?r.ajax({url:"https://www.baidu.com/sugrec?wd="+encodeURIComponent(e)+"&prod=open_baike&cb=window.baidu.sug&oe=gb18030",dataType:"script",scriptCharset:"GBK"}):window.baidu.sug({q:""})},renderSuggestion:function(e){if(s.list.length<=0)e.find("#suggestion").hide();else{5<=s.list.length&&e.find("#suggestion").addClass("sugbg");for(var t="",i=0;i<s.list.length;i++)s.list[i].match(s.list[0])?t+='<li class="matched">'+s.list[i].replace(s.list[0],'<span class="highlight">'+s.list[0]+"</span>")+"</li>":t+="<li>"+r("<div>").text(s.list[i]).html()+"</li>";e.find("#suggestion > div").html(t),e.find("#suggestion").show()}s.selected=0},hoverSuggestion:function(e){0<s.list.length?(e.find("#suggestion div li").removeClass("selected"),0<=s.selected-1&&e.find("#suggestion div li").eq(s.selected-1).addClass("selected")):s.requestSuggestion(r.trim(e.find("#query").val()))},selectSuggestion:function(e){0<s.list.length&&e.find("#query").val(s.list[s.selected-1])},closeSuggestion:function(e){s.selected=0,s.list=[],e.find("#suggestion > div").html(""),e.find("#suggestion").hide()},input:function(e){clearTimeout(i);var t=r.trim(e.find("#query").val());i=setTimeout(function(){s.requestSuggestion(t)},200)},search:function(e){""===r.trim(e.find("#query").val())&&e.find("#query").val("百度百科"),e.find("#searchQueryWord").val(e.find("#query").val()),e.find("#searchQueryForm").submit(),s.closeSuggestion(e)},searchLemma:function(e){""===r.trim(e.find("#query").val())&&e.find("#query").val("百度百科"),e.find("#searchLemmaQuery").val(e.find("#query").val()),e.find("#searchLemmaForm").submit()},searchEnter:function(e){""===r.trim(e.find("#query").val())&&e.find("#query").val("百度百科"),e.find("#searchEnterWord").val(e.find("#query").val()),e.find("#searchEnterForm").submit(),s.closeSuggestion(e)}};function n(t){window.baidu=window.baidu||{},window.baidu.sug=function(e){s.list=function(e){if(!e)return[];var t=[];return e.forEach(function(e){t.push(e.q)}),t}(e.g),s.renderSuggestion(t)}}t.on("searchInOtherProducts",function(e,t){var i=t.attr("data-href"),t=t.attr("href");i&&t&&s.searchInOtherProducts(r(this),i,t)}),t.on("suggestion:shiftUp",function(){s.selected=0<=(s.selected-1)%s.list.length?(s.selected-1)%s.list.length:(s.selected-1)%s.list.length+s.list.length,s.hoverSuggestion(r(this)),s.selectSuggestion(r(this))}),t.on("suggestion:shiftDown",function(){s.selected=(s.selected+1)%s.list.length<s.list.length?(s.selected+1)%s.list.length:(s.selected+1)%s.list.length-s.list.length,s.hoverSuggestion(r(this)),s.selectSuggestion(r(this))}),t.on("suggestion:hover",function(e,t){s.selected=t.index()+1,s.hoverSuggestion(r(this))}),t.on("suggestion:leave",function(){s.selected=0,s.hoverSuggestion(r(this))}),t.on("suggestion:close",function(){s.closeSuggestion(r(this))}),t.on("suggestion:select",function(){s.selectSuggestion(r(this))}),t.on("searchbar:focus",function(){n(r(this))}),t.on("searchbar:input",function(){n(r(this)),s.input(r(this))}),t.on("searchbar:search",function(){s.search(r(this))}),t.on("searchbar:searchLemma",function(){s.searchLemma(r(this))}),t.on("searchbar:searchEnter",function(){s.searchEnter(r(this))}),t.find(".search .nav a").on("click",function(e){return r(this).trigger("searchInOtherProducts",[r(this)]),!1}),t.find("#query").on("keydown",function(e){switch(e.keyCode){case 38:r(this).trigger("suggestion:shiftUp"),e.preventDefault();break;case 40:r(this).trigger("suggestion:shiftDown"),e.preventDefault();break;case 9:case 27:r(this).trigger("suggestion:close");break;case 13:r(this).trigger("searchbar:searchEnter"),e.preventDefault()}}),t.find("#query").on("focus",function(){r(this).trigger("searchbar:focus")}),t.find("#query").on("keyup",function(e){e=e.keyCode;(48<=e&&e<=57||65<=e&&e<=90||186<=e&&e<=192||8===e||32===e||220===e)&&r(this).trigger("searchbar:input")}),t.find("#suggestion div").on("mouseover","li",function(e){r(this).trigger("suggestion:hover",[r(this)])}),t.find("#suggestion div").on("mouseleave",function(e){r(this).trigger("suggestion:leave")}),t.find("#suggestion div").on("click","li",function(e){r(this).trigger("suggestion:select"),r(this).trigger("searchbar:search")}),t.find("#suggestion #close").on("click",function(){r(this).trigger("suggestion:close")}),t.find("#search").on("click",function(){r(this).trigger("searchbar:search")}),t.find("#searchLemma").on("click",function(){r(this).trigger("searchbar:searchLemma")}),r("*").on("click",function(e){r(this).parents(".wgt-searchbar")===t?e.stopPropagation():t.trigger("suggestion:close")}),e=t.find("#query").val(),o.ipad()||t.each(function(){0<r(this).parents(".header-wrapper").length&&(r(this).find("#query").val("").focus().val(e),n(r(this)))})}});
;/*!wiki-common:widget/component/share/share.js*/
define("wiki-common:widget/component/share/share",function(e,r,t){var i=e("wiki-common:widget/component/share/dep/qrcode"),a=e("wiki-common:widget/util/url"),s=e("wiki-common:widget/lib/jquery/jquery");function n(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}function c(e){var r=e;if(n(e)){var t=[].slice.call(arguments);if("function"==typeof Object.assign)r=Object.assign.apply(null,t);else for(var i=1;i<t.length;i++)if(n(t[i]))for(var a in t[i])t[i].hasOwnProperty(a)&&(r[a]=t[i][a]);else console&&console.error&&console.error("assign Error: arguments should be Object")}return r}var o=s(".J-wgt-side-share-qrcode");t.exports={param:{title:window.document.title,url:window.location.href,pic:"https://bkssl.bdimg.com/cms/static/baike.png",desc:""},init:function(e){this.hasGenerateQrcode=!1,this.initParam(e),this.initEvent()},initParam:function(e){n(e)&&(e.desc&&80<e.desc.length&&(e.desc=e.desc.substr(0,80)+"..."),this.param=c(this.param,e))},initEvent:function(){var e=this;s(".J-wgt-side-share__cnt__share").on("click",function(){e.triggerShare(s(this).attr("data-type"))}),s(".J-wgt-side-share-qrcode__header__close").click(function(){o.hide()})},updateParam:function(e){n(e)&&(this.param=c(this.param,e))},generateQrcode:function(e,r){new i(e,{width:180,height:180}).makeCode(r)},setQuery:function(e,r){return(r=r||window.location.href).split("?")[0]+"?"+a.setQuery(e,r)},getLinkMap:function(){var e={sina:{mainUrl:"https://service.weibo.com/share/share.php",searchQuery:{url:this.param.url,title:this.param.title+this.param.desc,pic:this.param.pic,appkey:"936491597",share_fr:"pc_sina"}},qzone:{mainUrl:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey",searchQuery:{url:this.param.url,title:this.param.title,pics:this.param.pic,summary:this.param.desc,share_fr:"pc_qzone"}},qq:{mainUrl:"http://connect.qq.com/widget/shareqq/index.html",searchQuery:{url:this.param.url,title:this.param.title,pics:this.param.pic,summary:this.param.desc,share_fr:"pc_qq"}},tieba:{mainUrl:"http://tieba.baidu.com/f/commit/share/openShareApi",searchQuery:{url:this.param.url,title:this.param.title,pic:this.param.pic,share_fr:"pc_tieba"}}};return e.weibo=e.sina,e},generateShareLink:function(e){var r,t="";return this.linkMap=this.getLinkMap(),this.linkMap.hasOwnProperty(e)&&(r=this.linkMap[e].mainUrl,e=this.linkMap[e].searchQuery,t=r+"?"+(e=a.jsonToQuery(e,!0))),t},triggerShare:function(e){switch(e){case"sina":case"weibo":case"qzone":case"qq":case"tieba":var r=this.generateShareLink(e);window.open(r);break;case"qrcode":case"wechat":var t;this.hasGenerateQrcode||(r=document.getElementById("J-wgt-side-share-qrcode__img"),t=this.setQuery({share_fr:"pc_qrcode"},this.param.url),this.generateQrcode(r,t),this.hasGenerateQrcode=!0),o.show();break;default:console&&console.error&&console.error("sideShare Error: unknown share type")}},openShareLink:function(e,r){this.updateParam(r),this.triggerShare(e)}}});
;/*!wiki-common:widget/component/shareBubble/shareBubble.js*/
define("wiki-common:widget/component/shareBubble/shareBubble",function(e,s,n){"use strict";var o=e("wiki-common:widget/lib/jquery/jquery"),i=e("wiki-common:widget/lib/jsmart/jsmart"),a=e("wiki-common:widget/ui/bubble/bubble"),t=e("wiki-common:widget/component/share/share"),c=e("wiki-common:widget/component/share/dep/qrcode"),h=e("wiki-common:widget/util/url"),r=e("wiki-common:node_modules/clipboard/dist/clipboard"),l=e("wiki-common:widget/tools/clickstream/clickstream");function d(e){this.$host=o(e.host),this.secondId=e.secondId,this.shareData=e.shareData||{},this.beforeShare=e.beforeShare||o.noop,this.pos=e.pos||"leftAuto",this.marginFromHost=e.marginFromHost||15,this.classNames=e.classNames||"",this.isShow=e.isShow||!1,this.page=e.page,this.secondVideoType=e.secondVideoType,this.albumId=e.albumId,this.initializeBubble(),this.initializeEvents()}d.prototype={constructor:d,update:function(e){this.shareData=o.extend(this.shareData,e)},share:function(e){this.beforeShare();var s=h.getQuery("secondId",this.shareData.url),n=(o.get("/api/second/dynamic/share?secondId="+s),this);o.ajax({url:"/api/common/genbkshorturl?url="+encodeURIComponent(this.shareData.url),success:function(e){0===e.errno&&e.shortUrl&&n.update({url:e.shortUrl})},error:function(e){console.log("err",e)},complete:function(){"wechat"===e?n.share2WeChat():n.share2Others(e)}})},share2WeChat:function(){var e=new a({host:o(this.bubble.getNode()).find('[data-channel="wechat"]'),content:'<div class="bubble-content"></div>',classNames:"lemmaWgt-secondsKnow-dialog-qrcode-bubble",marginFromHost:15,pos:"bottomAuto",showTail:!0,hideWhenBlur:!0,animation:"SLIDE"});new c(o(e.getNode()).find("div").get(0),{width:180,height:180}).makeCode(this.shareData.url),e.show()},share2Others:function(e){var s;if("link"===e)return(s=this.albumId?o(".J-copy-link-"+this.albumId):o(".J-copy-link-"+this.secondId)).show(),void setTimeout(function(){s.hide()},3e3);t.openShareLink(e,{url:this.shareData.url,title:this.shareData.title,pic:this.shareData.pic})},initializeBubble:function(){this.bubble=new a({host:this.$host,content:new i('<li class="bubble-content">\n<a href="javascript:;" class="secondsknow-share-icon" nslog-type="10002511" data-channel="wechat"><em class="cmn-icon cmn-icons cmn-icons_logo-wechat secondsknow-share-icon__em"></em></a>\n<a href="javascript:;" class="secondsknow-share-icon" nslog-type="10002512" data-channel="qzone"><em class="cmn-icon cmn-icons cmn-icons_logo-qzone secondsknow-share-icon__em"></em></a>\n<a href="javascript:;" class="secondsknow-share-icon" nslog-type="10002513" data-channel="qq"><em class="cmn-icon cmn-icons cmn-icons_logo-qq secondsknow-share-icon__em"></em></a>\n<a href="javascript:;" class="secondsknow-share-icon" nslog-type="10002514" data-channel="weibo"><em class="cmn-icon cmn-icons cmn-icons_logo-sina-weibo secondsknow-share-icon__em"></em></a>\n<a href="javascript:;" class="secondsknow-share-icon" nslog-type="10002514" data-channel="link"><em class="cmn-icon cmn-icons cmn-icons_logo-share-link J-link secondsknow-share-icon__em J-link-{%$secondId|f_escape_xml%} share-link"></em></a>\n</li>').fetch({secondId:this.secondId}),classNames:this.classNames,marginFromHost:this.marginFromHost,pos:this.pos,showTail:!0,hideWhenBlur:!0,animation:"SLIDE"})},initializeEvents:function(){(n=this).isShow?n.bubble.show():n.$host.on("click",function(){n.bubble.show()}),o(n.bubble.getNode()).on("click","a",function(){var e=o(this).attr("data-channel"),s=0;switch(n.share(e),e){case"wechat":s=1;break;case"qzone":s=5;break;case"qq":s=4;break;case"weibo":s=3;break;case"link":s=9}l.logActClick({page:n.page,element:"sharebtnlayer",secondId:n.secondId,secondVideoType:n.secondVideoType,albumId:n.albumId,sharetype:s})});var n=this;new r(".J-link-"+this.secondId,{text:function(){return n.shareData.url}})}},n.exports=d});
;/*!wiki-common:widget/component/superLogger/superLogger.es.js*/
define("wiki-common:widget/component/superLogger/superLogger.es",function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function o(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach(function(e){var t,n;t=o,n=r[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;function r(e){c.ajax({type:"GET",url:u+"/baike/log/common",dataType:"jsonp",data:{params:e}})}var c=e("wiki-common:widget/lib/jquery/jquery"),f="super_logger_error",u="//cstm.baidu.com/v1",a={createSocketTask:function(){var o=this,e=new Promise(function(e,t){var n;"undefined"!=typeof WebSocket?((n=new WebSocket("wss:".concat(u,"/baike/log"))).addEventListener("open",function(){e(n)}),n.addEventListener("error",function(e){o.socketTask=null;e={name:f,act:"error",pf:"pc",custom:JSON.stringify({res:JSON.stringify(e)})};r(JSON.stringify(e)),t()}),n.addEventListener("close",function(e){o.socketTask=null;e={name:f,act:"close",pf:"pc",custom:JSON.stringify({res:JSON.stringify(e)})};r(JSON.stringify(e)),t()})):(o.socketTask=null,r(JSON.stringify({name:f,act:"no",pf:"pc"})),t())});return this.socketTask=e,this.socketTask},buildData:function(e){var t=function(){var t={url:location.href,referrer:document.referrer},e=document.cookie;if(!e)return t;var e=e.split("; "),n="BAIDUID BIDUPSID H_WISE_SIDS".split(" ");return e.forEach(function(e){e=e.split("=");-1<n.indexOf(e[0])&&(t[e[0]]=e[1])}),t}();return e.app=JSON.stringify(t),JSON.stringify(e)},send:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};n.t=Date.now(),n.pf="pc",this.socketTask||this.createSocketTask(),this.socketTask.then(function(e){e.send(t.buildData(n))},function(){t.sendHttpRequest(n)})},close:function(){"undefined"!=typeof WebSocket&&this.socketTask&&this.socketTask.then(function(e){e.close()})},sendHttpRequest:function(e){r(this.buildData(e))}};c(window).on("unload",function(){a.close()}),t.default={sendHttpRequest:function(e){a.sendHttpRequest(e)},send:function(e,t){var n=JSON.stringify(function e(t){{if("number"==typeof t||"boolean"==typeof t||t instanceof RegExp||t instanceof Date)return String(t);if("object"===i(t)&&null!=t)for(var n in t)t.hasOwnProperty(n)&&(t[n]=e(t[n]));else if(Array.isArray(t))for(var o=0;o<t.length;o++)t[o]=e(t[o])}return t}(function e(t){var n;if("string"==typeof t||"number"==typeof t||"boolean"==typeof t||"function"==typeof t||void 0===t||null==t)n=t;else if(Array.isArray(t)){n=[];for(var o=0;o<t.length;o++)n[o]=e(t[o])}else if("object"===i(t))for(var r in n={},t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));else n=t;return n}(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{})));a.send({name:e,act:t,custom:n})},sendClk:function(e,t){this.send(e,"clk",t)},sendView:function(e,t){this.send(e,"view",t)},sendScreenView:function(e,t){this.send(e,"screenView",t)},sendState:function(e,t){this.send(e,"state",o({duration:t},2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}))},sendPv:function(e,t){this.send(e,"pv",t)},sendAjax:function(e,t,n){this.send(e,"ajax",o({status:t},n))}},n.exports=t.default});
;/*!wiki-common:widget/component/testElem/testElem.js*/
define("wiki-common:widget/component/testElem/testElem",function(e,i,n){"use strict";var t=e("wiki-common:widget/util/string"),o=e("wiki-common:widget/component/nslog/nslog");function r(e,i){if(!e||1!==e.nodeType)return{isValid:!1,reason:"elemNotExist"};var n,t,o,r=0;do{if(e)if((n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle)&&"NONE"==n.display.toUpperCase()&&(t=!0,o="elemCSSHidden"),!t&&n&&("HIDDEN"==n.visibility.toUpperCase()||0===parseInt(n.opacity)||parseInt(n["z-index"])<0)&&(t=!0,o="elemCSSInvisible"),t&&o)return{isValid:!1,reason:o}}while(r++,!(e=e.parentNode)||e==document||30<r);if(i)for(var s in i)if("function"==typeof i[s]&&i[s]())return{isValid:!1,reason:s};return{isValid:!0}}var s={test:function(e){var i,n={};for(i in e){var t=e[i];t&&!t.nodeType&&t.node?n[i]=r(t.node,t.validations):n[i]=r(t)}return n},log:function(e,i,n){e=s.test(e);if(!i)return e;e=t.jsonStringify(e);o(i,window.location.href,{blockInfo:e,page:n||""})}};n.exports=s});
;/*!wiki-common:widget/component/themeInput/themeInput.js*/
define("wiki-common:widget/component/themeInput/themeInput",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(t("wiki-common:widget/lib/jquery/jquery")),a=s(t("wiki-common:widget/lib/jsmart/jsmart")),o=s(t("wiki-common:widget/ui/tagsInput/tagsInput")),u=s(t("wiki-common:widget/util/safeCall"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var c=new a.default('<span class="sticker{%if $className%} {%$className|f_escape_xml%}{%/if%}"\n    {%if $data%}\n        {%foreach $data as $key => $value%}\n        data-{%$key%}="{%$value|f_escape_xml%}"\n        {%/foreach%}\n    {%/if%}\n>\n<span class="tag-con">{%$text|trim|escape|f_escape_xml%}</span>\n{%if $dom%}\n{%$dom|escape:none%}\n{%/if%}\n<a href="javascript:void(0);" class="remove">×</a>\n</span>\n'),t=function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this,n=s;if(!(e instanceof n))throw new TypeError("Cannot call a class as a function");if(!t)throw new Error("[TaskLemmaInput Exception]: No arguments.");if(!(0,i.default)(t.container).length)throw new Error('[TaskLemmaInput Exception]: Invalid argument "container".');var a=this;this._init(t),0<this.themeList.length&&i.default.each(this.themeList,function(t,e){a.tagsInputInstance.addTags([{text:"".concat(e.label,"（").concat(e.value,"）"),data:{value:e.value,label:e.label}}])}),this._setInputBoxStatus(),this._createSug(),this._eventBind(),this.tagsInputInstance.tagsInput.on("keyup mouseup",function(){a._setContent()}),this._nonExistBind()}var t,e,n;return t=s,(e=[{key:"_init",value:function(t){var e=this;this.container=(0,i.default)(t.container),this.container.html(['<div class="wgt-taskThemeInput-pool">','<div class="wgt-taskThemeInput-input-container">',"<pre></pre>",'<textarea placeholder="'+(t.placeholder||"")+'" class="wgt-taskThemeInput-input"></textarea>',"</div>","</div>",'<ul class="wgt-taskThemeInput-suggestion"></ul>'].join("")),this.tagsBox=this.container.find(".wgt-taskThemeInput-pool"),this.tagsInput=this.container.find(".wgt-taskThemeInput-input"),this.sugBox=this.container.find(".wgt-taskThemeInput-suggestion"),this.tagsMaxCount=isNaN(parseInt(t.tagsMaxCount,10))?1/0:Math.abs(parseInt(t.tagsMaxCount,10)),this.enableNotExisted=t.enableNotExisted||!1,this.enableFeatureLemma=t.enableFeatureLemma||!1,this.onTagAdd=t.onTagAdd,this.onTagRemove=t.onTagRemove,this.onTagsInputComplete=t.onTagsInputComplete,this.themeList=t.themeList&&0<t.themeList.length?t.themeList:[],this.themeStatus=t.themeStatus||0,this.tagsInputInstance=new o.default({tagsBox:this.tagsBox,tagsInput:this.tagsInput,tagsMaxCount:this.tagsMaxCount,TriggerTagAdd:"ENTER",ignoreSpace:!0,validation:function(t){i.default.ajax({type:"POST",url:"/wikicategory/api/getstarmapbyids",data:{treeIds:t.join("\n"),status:e.themeStatus},dataType:"JSON",success:function(t){t.errno||e._handleValidation(t.data)}})},onTagRemove:function(t){e._setInputBoxStatus(),e._setSugStatus(),(0,u.default)(this.onTagRemove,[t],e)}})}},{key:"_handleValidation",value:function(t){var e=this;t.starMapList.map(function(t){(0,i.default)(".tag",e.tagsInputInstance.tagsBox).length+(0,i.default)(".sticker",e.tagsInputInstance.tagsBox).length<e.tagsMaxCount&&e._handleAlready(t)}),t.notExists.map(function(t){(0,i.default)(".tag",e.tagsInputInstance.tagsBox).length+(0,i.default)(".sticker",e.tagsInputInstance.tagsBox).length<e.tagsMaxCount&&e._handleNonexist(t)}),this._setSugStatus()}},{key:"_handleAlready",value:function(t){var e=this.tagsInputInstance.addTagHandle({text:"".concat(t.label,"（").concat(t.value,"）"),data:{value:t.value,label:t.label}});(0,u.default)(this.onTagAdd,[["".concat(t.label,"（").concat(t.value,"）")],e],this),this._setTagsInputInstanceStatus(),this._setInputBoxStatus(),this._removeFromInputBox(t.value)}},{key:"_handleNonexist",value:function(t){var e=c.fetch({text:t,className:"nonexist",dom:this.enableNotExisted?'<a href="javascript: void(0);" class="J-tasktheme-add">添加</a>':"",data:{title:t}});this.enableNotExisted||(0,i.default)(e).addClass("disable-click"),this._setStickerStatus(e,t)}},{key:"_setStickerStatus",value:function(t,e){this.tagsBox.find(".wgt-taskThemeInput-input-container").before(t),this._setContent(),this._removeFromInputBox(e)}},{key:"_createSug",value:function(){this.sugBox.html(['<li class="nonexist-selector">','<div>未收录主题<span class="nonexist-selector-num"></span>个。','（<span class="nonexist-selector-cur">1</span>/<span class="nonexist-selector-num"></span>） ','<a href="javascript: void(0);" class="nonexist-selector-next">查看</a>',"&nbsp;&nbsp;|&nbsp;&nbsp;",'<a href="javascript: void(0);" class="nonexist-selector-all">',this.enableNotExisted?"添加全部":"删除全部","</a>","</div>","</li>"].join("")),this.tagsBox.append('<div class="wgt-taskThemeInput-cover"></div>')}},{key:"_eventBind",value:function(){var t=this;this.tagsBox.on("click",".tag .remove",function(){(0,i.default)(this).parent(".tag").remove(),t._setSugStatus()})}},{key:"_nonExistBind",value:function(){var t=this;this.enableNotExisted&&this.tagsBox.on("click",".nonexist .J-tasktheme-add",function(){t._handleAlready({lemmaTitle:(0,i.default)(this).parent(".nonexist").data("title")}),(0,i.default)(this).parent(".nonexist").remove(),t._setSugStatus()}),this.sugBox.on("click",".nonexist-selector-all",function(){(this.enableNotExisted?t.tagsBox.find(".nonexist").find(".J-tasktheme-add"):t.tagsBox.find(".nonexist").find(".remove")).click()}),this.tagsBox.on("click",".nonexist .remove",function(){(0,i.default)(this).parent(".nonexist").remove(),t._setSugStatus()}),this.sugBox.on("click",".nonexist-selector-next",function(){t._lookOver("nonexist",(0,i.default)(this))})}},{key:"_lookOver",value:function(t,e){var n=this.tagsBox.find(".".concat(t)),t=e.siblings(".".concat(t,"-selector-cur")),a=+t.text();1<n.length&&("查看"===e.text()?e.text("查看下一个"):(a===n.length?a=1:a+=1,t.text(a))),this._tagsBoxScrollTo(n.eq(a-1))}},{key:"_tagsBoxScrollTo",value:function(t){var e;t.length&&this.tagsBox.find(t).length&&(this.tagsBox.find(".sticker").removeClass("focus"),t.addClass("focus"),t=t.offset().top,e=this.tagsBox.offset().top,this.tagsBox.scrollTop(t+this.tagsBox.scrollTop()-e-5))}},{key:"_setContent",value:function(){var t=this.tagsInputInstance.tagsInput.val();this.tagsInputInstance.tagsBox.find(".wgt-taskThemeInput-input-container pre").html(t+"<br/><br/>")}},{key:"_setSugStatus",value:function(){this.tagsBox.find(".sticker").removeClass("focus"),this._setSugItem("nonexist"),(0,i.default)(".tag",this.tagsInputInstance.tagsBox).length>=this.tagsMaxCount?this.sugBox.hide():this.sugBox.show()}},{key:"_setSugItem",value:function(t){var e=this.tagsBox.find(".".concat(t)).length;0<e?(this.sugBox.show(),this.sugBox.find(".".concat(t,"-selector")).show(),this.sugBox.find(".".concat(t,"-selector-num")).text(e),this.sugBox.find(".".concat(t,"-selector-cur")).text(1),this.sugBox.find(".".concat(t,"-selector-next")).text("查看")):(this.sugBox.find(".".concat(t,"-selector-num")).text(""),this.sugBox.find(".".concat(t,"-selector")).hide())}},{key:"_setTagsInputInstanceStatus",value:function(){var t=(0,i.default)(".tag",this.tagsInputInstance.tagsBox);t.length>=this.tagsMaxCount&&(0,u.default)(this.onTagsInputComplete,[(0,i.default)(".tag-con",t).map(function(){return(0,i.default)(this).text()}),t],this)}},{key:"_removeFromInputBox",value:function(n){var t=this.tagsInputInstance.tagsInput.val().split("\n"),a=[],t=(i.default.each(t,function(t,e){e=i.default.trim(e);e&&""!==e&&+e!=+n&&a.push(e)}),a.join("\n"));0<a.length&&(t+="\n"),this.tagsInputInstance.tagsInput.val(t)}},{key:"_setInputBoxStatus",value:function(){(0,i.default)(".tag",this.tagsInputInstance.tagsBox).length>=this.tagsMaxCount?(this.tagsInputInstance.tagsInput.hide(),this.tagsInputInstance.tagsBox.find(".wgt-taskThemeInput-input-container pre").hide()):(this.tagsInputInstance.tagsInput.show(),this.tagsInputInstance.tagsBox.find(".wgt-taskThemeInput-input-container pre").show()),this._setContent()}},{key:"getThemes",value:function(){var t=this.tagsInputInstance.getTags(),e=[];return t.map(function(t){e.push({label:t.data.label,value:parseInt(t.data.value,10)||0})}),e}}])&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}();e.default=t,n.exports=e.default});
;/*!wiki-common:widget/component/unameFiller/unameFiller.js*/
define("wiki-common:widget/component/unameFiller/unameFiller",function(i,o,e){"use strict";var n=i("wiki-common:widget/lib/jquery/jquery"),t=i("wiki-common:widget/ui/dialog/dialog"),a={_initDialog:function(){a._dialog=new t({icon:"WARNING",classNames:"wgt-unameFiller",title:"请设置您的用户名以继续操作",content:'<div id="wgt-unameFiller-form-container"></div>'})},show:function(o){var i;a._dialog?a._dialog.show():(a._initDialog(),n.ajax({url:"https://passport.baidu.com/passApi/js/wrapper.js?cdnversion",dataType:"script"}),i=setInterval(function(){window.passport&&(clearInterval(i),window.passport.use("fillUserName",{tangram:!0},function(i){i=new i.passport.fillUserName({product:"wk",staticPage:"https://baike.baidu.com/static/wiki-common/html/v3Jump.html"});i.on("fillUserNameSuccess",function(i){a._dialog.hide(),"function"==typeof o?o():window.location.reload(),i.returnValue=!1}),i.render("wgt-unameFiller-form-container"),a._dialog.show()}))},100))}};e.exports=a});
;/*!wiki-common:widget/component/uploadImg/uploadImg.js*/
define("wiki-common:widget/component/uploadImg/uploadImg",function(o,e,n){"use strict";var i=o("wiki-common:widget/lib/jquery/jquery"),s=!1,a=function(o){var e=o.tk,n=o.success,o=o.error;return i.ajax({url:"/common/image/init",type:"POST",data:{tk:e},success:n,error:o})},f=function(o){var e=o.url,n=o.tk,r=o.success,o=o.error;return i.ajax({url:"/common/image/save",type:"POST",data:{url:e,tk:n},success:r,error:o})};e.uploadFile=function(o){function e(o){f({tk:r,url:o,success:i,error:function(){u({errmsg:"图片url存储失败"})}})}function t(o){var r;r={info:o,success:e,error:function(){u({errmsg:"上传bos失败"})}},(o=new baidubce.bos.Uploader({browse_button:"#file",multi_selection:!0,bos_bucket:r.info.bucketName,bos_ak:r.info.ak,bos_sk:r.info.sk,bos_endpoint:r.info.endpoint,bos_multipart_parallel:5,bos_multipart_auto_continue:!0,uptoken:r.info.sessionToken,chunk_size:"8mb",max_file_size:"10mb",init:{FilesFilter:function(o,e){},FilesAdded:function(o,e){},BeforeUpload:function(o,e){},UploadProgress:function(o,e,n,r){},Key:function(o,e){return r.info.path},FileUploaded:function(o,e,n){r.success&&r.success(n.body.location,r.info.uuid)},NetworkSpeed:function(o,e,n,r){},UploadComplete:function(){},ListParts:function(o,e,n){},ChunkUploaded:function(o,e,n){},Aborted:function(o,e,n){},Error:function(o,e,n){r.error&&r.error(r.info.uuid)}}})).addFile(n),o.start()}var n=o.file,r=o.tk,i=o.success,c=o.error,u=function(o){c(o||{errmsg:"上传图片失败"})};a({tk:r,success:function(o){var e,n,r;0===o.errno?s?t(o):(e="https://baikebcs.bdimg.com/cms/wiki-common/lib/BceBosUploader.js",n=function(){t(o),s=!0},(r=document.createElement("script")).onload=function(){"function"==typeof n&&n()},r.src=e,document.body.appendChild(r)):u({errmsg:"初始化bos失败"})},error:function(){u({errmsg:"初始化bos失败"})}})},e.urlReSave=function(o){var e=o.url,n=o.crop,r=o.isCutPercent,t=o.success,o=o.error,e={url:e};n&&(e.needProcess=1,e.rotate=n.rotate,e.cutX=n.x,e.cutY=n.y,e.isCutPercent=r,e.cutWidth=n.width,e.cutHeight=n.height),i.ajax({url:"/common/image/fetch",type:"POST",data:e,success:t,error:o})}});
;/*!wiki-common:widget/component/urls/getLemmaUrl.js*/
define("wiki-common:widget/component/urls/getLemmaUrl",function(e,t,n){"use strict";function s(e,t){return t?"/subview/"+e+"/"+t+".htm":"/view/"+e+".htm"}function i(e,t){return"/item/"+encodeURIComponent(t)+"/"+e}n.exports=function(){var e="";switch(arguments.length){case 1:e=s(t=parseInt(arguments[0]));break;case 2:var t=parseInt(arguments[0]),n=parseInt(arguments[1]);t&&(n&&"number"==typeof arguments[1]?e=s(t,n):"string"==typeof arguments[1]&&16168090<t&&(e=i(t,arguments[1])));break;default:var r=parseInt(arguments[0]),a=arguments[1],t=parseInt(arguments[2]),n=parseInt(arguments[3]);r&&a&&t&&(e=16168090<r?i(r,a):s(t,n))}return e}});
;/*!wiki-common:widget/component/userLogin/userLogin.js*/
define("wiki-common:widget/component/userLogin/userLogin",function(n,o,i){"use strict";var t=n("wiki-common:widget/lib/jquery/jquery"),e={onLogin:function(){},onUnlogin:function(){},onLoginSuccess:function(){window.location.href=window.location.href.replace(/#.*$/g,"")},onLoginFail:function(){}},s=[],c={login:function(n,o){t.ajax(t.extend({type:"GET",url:"/api/usercenter/login",dataType:"JSON",cache:!1,success:function(n){o(n)}},n.ifMsg?{data:{msg:1}}:{}))},loginPop:function(n,o){var i="https://passport.baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+(new Date).getTime();t.getScript(i,function(){o()})}},a={checkIfLogin:function(n){var i=(n=n||{}).onLogin||e.onLogin,t=n.onUnlogin||e.onUnlogin;c.login(n,function(n){if(n.isLogin){n.name=n.displayName,i(n);for(var o=0;o<s.length;o++)s[o].handleLogon&&s[o].handleLogon(n),"function"==typeof s[o].onLogin&&s[o].onLogin(n)}else t()})},showLoginPop:function(n){var i=(n=n||{}).onLoginSuccess||e.onLoginSuccess,t=n.onLoginFail||e.onLoginFail;window.passport||a.instance||window.useLoginInstance?(window.passport&&window.passport.hook&&window.passport.hook.login&&(window.passport.hook.login.loginSuccess=function(n,o){i(),o.returnValue=!1},window.passport.hook.login.loginErr=function(n,o){t()}),a.instance&&a.instance.show(),window.useLoginInstance&&window.useLoginInstance.show()):c.loginPop({},function(){var n,o=window.passport;o&&(n=window.location.protocol+"//"+window.location.host||"https://baike.baidu.com",o=o.pop.init({loginVersion:"v5",apiOpt:{u:window.location.href.replace(/#.*$/g,""),safeFlag:0,product:"wk",qrcode:3,sms:5,qrcode_animatin:1,staticPage:n+"/static/wiki-common/html/v3Jump.html"},cache:!0,tangram:!0,authsiteCfg:{act:"implicit"},authsite:["qzone","tsina","weixin"],registerLink:"https://passport.baidu.com/v2/?reg&regType=1&tpl=wk",onLoginSuccess:function(n){i(n),n.returnValue=!1},onSubmitedErr:function(n){t(n)}}),(a.instance=o).show(),window.useLoginInstance=o)})},logout:function(){window.location.href="https://passport.baidu.com/?logout&u="+encodeURIComponent(window.location.href)},regist:function(n){s.push(n)}};i.exports=a});
;/*!wiki-common:widget/component/userbar-n/userbar-n.js*/
define("wiki-common:widget/component/userbar-n/userbar-n",function(e,a,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=e("wiki-common:widget/lib/jquery/jquery"),m=e("wiki-common:widget/component/userLogin/userLogin"),i=e("wiki-common:widget/lib/jsmart/jsmart"),r=e("wiki-common:widget/util/browser"),l=e("wiki-common:widget/ui/bubble/bubble"),g={userbar:{unlogin:new i('{%if !$UIConfig.disableBaiduHome%}\n<li>\n<a href="http://www.baidu.com/" nslog="normal" nslog-type="10080109" >百度首页</a>\n</li>\n{%/if%}\n<li>\n<a data-action=\'login\' href="javascript:;" nslog="normal" nslog-type="10080110" >登录</a>\n</li>\n<li>\n<a href="https://passport.baidu.com/v2/?reg&regType=1&tpl=wk" nslog="normal" nslog-type="10080111" >注册<a>\n</li>\n'),login:new i('{%if !$UIConfig.disableBaiduHome%}\n<li>\n<a href="http://www.baidu.com/" nslog="normal" nslog-type="10080112" >百度首页</a>\n</li>\n{%/if%}\n<li class="userbar_user" data-action="showUserMenu">\n<a href="javascript:;" nslog="normal" nslog-type="10080113" ><span>{%$displayName|escape:html|escape:none%}</span><i class="icon-triangle-down"></i></a>\n</li>\n<li class="userbar_message" data-action="showUserMsg">\n<a href="javascript:;" nslog="normal" nslog-type="10080115" >消息<span class="userbar_message_new_num"></span><i class="icon-triangle-down"></i></a>\n</li>\n<li class="userbar_mall">\n<a href="/mall/" target="_blank" nslog="normal" nslog-type="10080114" >商城</a>\n</li>\n<li class="userbar_setting" data-action="showSetMenu">\n<a href="/usercenter/settings" nslog="normal" nslog-type="10080116" target="_blank"><em class="cmn-icon cmn-icons cmn-icons_cog"></em>设置<i class="icon-triangle-down"></i></a>\n</li>\n')},menu:{userMenu:new i('<ul>\n<li><a href="/usercenter/tasks#mine" target="_blank">我的任务</a></li>\n<li><a href="/usercenter/lemmas" target="_blank">我的词条</a></li>\n<li><a href="/usercenter/video" target="_blank">我的视频</a></li>\n<li><a href="/usercenter/discussion" target="_blank">我的讨论</a></li>\n<li><a href="/usercenter/userpage?uk={%$uk|f_escape_path%}&from=userbar" target="_blank">我的主页</a></li>\n{%if $hasECertEntrance%}\n<li><a href="/enterprise/browse/usercenter" target="_blank">企业认证</a></li>\n{%/if%}\n{%if $isAuthLemma%}\n<li><a href="/member/mylemmas" target="_blank">我的订单</a></li>\n{%/if%}\n<li class="bottom logout"><a data-action="logout" href="javascript:;">退出</a></li>\n</ul>\n'),userMsg:new i('<ul>\n<li class="top">\n<a href="/wikimessage/msghome#/notify" target="_blank">\n<span class="userMsgType">通知</span>{%if $baikeMsg.notice && $baikeMsg.notice.num > 0%}\n<span class="userMsgCount">{%if $baikeMsg.notice.num < 100%}{%$baikeMsg.notice.num|f_escape_xml%}{%else%}99{%/if%}</span>{%/if%}\n</a>\n</li>\n<li class="center">\n<a href="/wikimessage/msghome#/private" target="_blank">\n<span class="userMsgType">私信</span>{%if $baikeMsg.privateMsg && $baikeMsg.privateMsg.num > 0%}\n<span class="userMsgCount">{%if $baikeMsg.privateMsg.num < 100%}{%$baikeMsg.privateMsg.num|f_escape_xml%}{%else%}99+{%/if%}</span>{%/if%}\n</a>\n</li>\n{%if $hasAnonymous%}\n<li class="bottom">\n<a href="/wikimessage/msghome#/anonymous" target="_blank">\n<span class="userMsgType">编辑咨询</span>{%if $baikeMsg.privateAnonyMsg && $baikeMsg.privateAnonyMsg.num > 0%}\n<span class="userMsgCount">{%if $baikeMsg.privateAnonyMsg.num < 100%}{%$baikeMsg.privateAnonyMsg.num|f_escape_xml%}{%else%}99+{%/if%}</span>{%/if%}\n</a>\n</li>\n{%/if%}\n</ul>'),setMenu:new i('<ul>\n<li class="top"><a href="https://passport.baidu.com/center" target="_blank">账号设置</a></li>\n<li><a href="/usercenter/settings#profile" target="_blank">资料设置</a></li>\n<li><a href="/usercenter/settings#message" target="_blank">消息设置</a></li>\n<li class="bottom logout"><a data-action="logout" href="javascript:;">退出</a></li>\n</ul>')},bubble:{lemmaMsg:new i('<ul>\n{%foreach $baikeMsg as $idx => $msg%}\n{%if $idx === "passedVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#passed" data-action="readMessage" data-msgType="3" target="_blank">您有{%$msg.num|f_escape_xml%}个版本审核已通过，请点击查看</a>\n</li>\n{%else if $idx === "partialVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#passed" data-action="readMessage" data-msgType="19" target="_blank">您有{%$msg.num|f_escape_xml%}个版本部分内容审核通过，请点击修改</a>\n</li>\n{%else if $idx === "failedVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#rejected" data-action="readMessage" data-msgType="4" target="_blank">您有{%$msg.num|f_escape_xml%}个版本审核未通过，请点击修改</a>\n</li>\n{%else if $idx === "deletedVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#rejected" data-action="readMessage" data-msgType="6" target="_blank">您有{%$msg.num|f_escape_xml%}个版本被删除，请点击查看</a>\n</li>\n{%else if $idx === "goodVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#passed-good" data-action="readMessage" data-msgType="7" target="_blank">您有{%$msg.num|f_escape_xml%}个版本被评为优质版本，请点击查看</a>\n</li>\n{%else if $idx === "featuredLemma" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#passed-featured" data-action="readMessage" data-msgType="8" target="_blank">您有{%$msg.num|f_escape_xml%}个词条被评为特色词条，请点击查看</a>\n</li>\n{%else if $idx === "deletedLemma" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#rejected" data-action="readMessage" data-msgType="5" target="_blank">您有{%$msg.num|f_escape_xml%}个词条被删除，请点击查看</a>\n</li>\n{%else if $idx === "featuredModified" && $msg.num > 0%}\n<li>\n<a href="/usercenter/lemmas#passed-featured" data-action="readMessage" data-msgType="9" target="_blank">您有{%$msg.num|f_escape_xml%}个特色词条被修改，请点击查看</a>\n</li>\n{%else if $idx === "tousu" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="2" target="_blank">您有{%$msg.num|f_escape_xml%}个投诉处理消息，请点击查看</a>\n</li>\n{%else if $idx === "passedPersonalVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/personal" data-action="readMessage" data-msgType="10" target="_blank">您的实名词条有1个版本已通过，请点击查看</a>\n</li>\n{%else if $idx === "failedPersonalVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/personal" data-action="readMessage" data-msgType="11" target="_blank">您的实名词条有1个版本未通过，请点击查看</a>\n</li>\n{%else if $idx === "deletedPersonalVersion" && $msg.num > 0%}\n<li>\n<a href="/usercenter/personal" data-action="readMessage" data-msgType="12" target="_blank">您的实名词条有1个版本被删除，请点击查看</a>\n</li>\n{%else if $idx === "second" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="13" target="_blank">您有{%$msg.num|f_escape_xml%}个秒懂消息，请点击查看</a>\n</li>\n{%else if $idx === "privateMsgBubble" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/private" data-action="readMessage" data-msgType="101" target="_blank">您收到了{%if $msg.num < 100%}{%$msg.num|f_escape_xml%}{%else%}99+{%/if%}条新私信，请点击查看</a>\n</li>\n{%else if $idx === "noticeAnnounce" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="15" target="_blank">您收到了{%if $msg.num < 100%}{%$msg.num|f_escape_xml%}{%else%}99+{%/if%}条官方公告，请点击查看</a>\n</li>\n{%else if $idx === "noticeActivity" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="14" target="_blank">您收到了{%if $msg.num < 100%}{%$msg.num|f_escape_xml%}{%else%}99+{%/if%}条活动邀请，请点击查看</a>\n</li>\n{%else if $idx === "noticeDiscussion" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="16" target="_blank">您收到了来自科星球的{%if $msg.num < 100%}{%$msg.num|f_escape_xml%}{%else%}99+{%/if%}条通知，请点击查看</a>\n</li>\n{%else if $idx === "discussionDaily" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="17" target="_blank">您收到了{%if $msg.num < 100%}{%$msg.num|f_escape_xml%}{%else%}99+{%/if%}份科星球周报，请点击查看</a>\n</li>\n{%else if $idx === "noticeUserThanks" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/notify" data-action="readMessage" data-msgType="18" target="_blank">您收到了用户的感谢，请点击查看</a>\n</li>\n{%else if $idx === "privateAnonyMsg" && $msg.num > 0%}\n<li>\n<a href="/wikimessage/msghome#/anonymous" data-action="readMessage" data-msgType="103" target="_blank">您收到了{%if $msg.num < 100%}{%$msg.num|f_escape_xml%}{%else%}99+{%/if%}条编辑咨询，请点击查看</a>\n</li>\n{%/if%}\n{%/foreach%}\n<li class="cancelAlarm"><a href="/usercenter/settings#message" target="_blank">不再接收此类消息</a></li>\n</ul>\n<a class="wgt-bubble-lemmaMsg_close" data-action="cancelAlarm" href="javascript:;">\n<em class="cmn-icon cmn-icons cmn-icons_close"></em>\n</a>\n')}};i.prototype.registerPlugin("modifier","hasElement",function(e,a){for(var n in e)if(e[n]==a)return!0;return!1});var u={userbar:function(e,a,n){switch(a){case"unlogin":case"login":e.html(g.userbar[a].fetch(n))}},menu:function(n,s,e,a){var i=new l({host:s,content:g.menu[e].fetch(a),pos:"bottom-center",marginFromHost:4,offset:{top:7},showTail:void 0===r.ie()||9<r.ie(),classNames:"wgt-bubble-"+e}),t=o(i.getNode());return s.mouseover(function(){var a=this;"showUserMenu"==o(a).attr("data-action")&&n.find(".userbar_user").addClass("spreadUserMenu"),"showSetMenu"===o(a).attr("data-action")&&n.find(".userbar_setting").addClass("spreadUserMenu"),i.show(function(){var e="";s.on("mouseleave",function(){e=setTimeout(function(){"showUserMenu"==o(a).attr("data-action")&&n.find(".userbar_user").removeClass("spreadUserMenu"),"showSetMenu"===o(a).attr("data-action")&&n.find(".userbar_setting").removeClass("spreadUserMenu"),i.hide()},100)}),t.on("mouseenter",function(){clearTimeout(e),t.on("mouseleave",function(){"showUserMenu"==o(a).attr("data-action")&&n.find(".userbar_user").removeClass("spreadUserMenu"),"showSetMenu"===o(a).attr("data-action")&&n.find(".userbar_setting").removeClass("spreadUserMenu"),i.hide()})})})}),t.on("click","a",function(){var e=o(this).attr("data-action");if(e)return"logout"===e&&m.logout(),!1}),t},bubble:function(e,a,n){e=new l({host:e,content:g.bubble[a].fetch(n),pos:"bottom-center",showTail:void 0===r.ie()||9<r.ie(),hideWhenBlur:!1,classNames:"wgt-bubble-"+a,marginFromHost:4,offset:{top:7,left:-80}}),n=o(e.getNode());return e.show(),n}};n.exports={buildUserbar:function(t,r,l){r="object"==s(r)&&r instanceof Array?r:[];m.checkIfLogin({ifMsg:!0,onUnlogin:function(){u.userbar(t,"unlogin",{UIConfig:{disableBaiduHome:l}})},onLogin:function(e){u.userbar(t,"login",o.extend(e,{UIConfig:{btns:r,disableBaiduHome:l}})),u.menu(t,t.find('li[data-action="showUserMenu"]'),"userMenu",{isAuthLemma:e.isAuthLemma,uk:e.uk,hasECertEntrance:e.hasECertEntrance}),u.menu(t,t.find('li[data-action="showSetMenu"]'),"setMenu");var a,n,s={baikeMsg:e.msgStatus,hasAnonymous:e.hasAnonymous},e=s.baikeMsg.privateMsg.num+s.baikeMsg.privateAnonyMsg.num+s.baikeMsg.notice.num,i=(0<e&&t.find(".userbar_message .userbar_message_new_num").html("("+e+")"),u.menu(t,t.find('li[data-action="showUserMsg"]'),"userMsg",s),0);for(a in s.baikeMsg)"notice"!==a&&"privateMsg"!==a&&(i+=s.baikeMsg[a].num);0<i&&(n=u.bubble(t.find('li[data-action="showUserMenu"]'),"lemmaMsg",s)).on("click","a",function(){var e,a=o(this).attr("data-action");switch(a){case"readMessage":e=o(this).attr("data-msgType");break;case"cancelAlarm":e="all"}if(e&&o.ajax({type:"GET",url:"/api/wikimessage/readmsgstatus",data:{type:e},dataType:"JSON",complete:function(e){n.remove()}}),"cancelAlarm"===a)return!1})}}),t.on("click","a",function(){var e=o(this).attr("data-action");if(e)return"login"===e&&m.showLoginPop(),!1})}}});
;/*!wiki-common:widget/component/userCard/userCard.js*/
define("wiki-common:widget/component/userCard/userCard",function(t,e,i){"use strict";var s=t("wiki-common:widget/lib/jquery/jquery"),s=t("wiki-common:widget/lib/jquery/jquery"),n=t("wiki-common:widget/lib/jsmart/jsmart"),a=t("wiki-common:widget/ui/bubble/bubble"),o=new n('<div class="wgt-userCard-bubble-content">\n<div class="bubble-top">\n<img src="{%$portraitUrl|default:\'\'|f_escape_xml%}" class="avatar"/>\n<div class="details">\n<p class="uname">\n{%$displayname|default:""|f_escape_xml%}\n{%if $contributeFlags.odpFlag.isShow == 1%}\n<img src="https://bkssl.bdimg.com/static/wiki-common/widget/component/userCard/resource/img/contribute-flag-1_c1b820f.png" alt="" class="contribute-flag-icon">\n{%/if%}\n{%if $contributeFlags.hotFlag.isShow == 1%}\n<img src="https://bkssl.bdimg.com/static/wiki-common/widget/component/userCard/resource/img/contribute-flag-2_eb180f9.png" alt="" class="contribute-flag-icon">\n{%/if%}\n{%if $contributeFlags.classFlag.isShow == 1%}\n<img src="https://bkssl.bdimg.com/static/wiki-common/widget/component/userCard/resource/img/contribute-flag-3_23e3d39.png" alt="" class="contribute-flag-icon">\n{%/if%}\n{%if $contributeFlags.starFlag.isShow == 1%}\n<img src="https://bkssl.bdimg.com/static/wiki-common/widget/component/userCard/resource/img/contribute-flag-4_44902f6.png" alt="" class="contribute-flag-icon">\n{%/if%}\n{%if $contributeFlags.discussionTalent.isShow%}\n<img src="https://bkssl.bdimg.com/static/wiki-common/widget/component/userCard/resource/img/contribute-flag-5_f959510.png" alt="" class="contribute-flag-icon">\n{%/if%}\n{%if $contributeFlags.discussionSuper.isShow%}\n<img src="https://bkssl.bdimg.com/static/wiki-common/widget/component/userCard/resource/img/contribute-flag-6_9df63e2.png" alt="" class="contribute-flag-icon">\n{%/if%}\n</p>\n<p class="level">等级：<em>{%$level|dafault:""|f_escape_xml%}</em></p>\n{%if $featuredLemmaCount%}\n<p class="featuredNum">特色词条：<em>{%$featuredLemmaCount|dafault:"0"|f_escape_xml%}</em></p>\n{%/if%}\n</div>\n</div>\n<div class="bubble-bottom">\n<p class="passedNum">通过版本：{%$commitPassedCount|dafault:"0"|f_escape_xml%}</p>\n<p class="passedRatio">通过率：{%$passRatio|dafault:"0"|f_escape_xml%}%</p>\n</div>\n<div class="bubble-cover"></div>\n</div>');n.prototype.registerPlugin("modifier","dafault",function(t,e){return t||e}),i.exports=function(i){s("body").on("mouseenter",i.host,function(){var e=s(this).data("bubble");e||((e=new a({host:s(this),classNames:"wgt-userCard-bubble",content:o.fetch({}),pos:"bottomLeft",marginFromHost:0,offset:{left:-63-(i.left||0),top:15},showTail:!0,hideWhenBlur:!1,animation:"SLIDE"})).getNode().find(".tail").css("left","63"-(i.left||0)),s.getJSON("/api/usercenter/getusercard?uk="+s(this).attr("data-uk"),function(t){t=s(o.fetch(t.data));e.setContent(t),e.getNode().find(".tail").css("left","63"-(i.left||0)),t.find(".bubble-cover").fadeOut(300)}),s(this).data("bubble",e)),e.show()}).on("mouseleave",i.host,function(){var t=s(this).data("bubble");t&&t.hide()})}});
;/*!wiki-common:widget/component/userMsg/userMsg.js*/
define("wiki-common:widget/component/userMsg/userMsg",function(o,n,t){"use strict";function e(o){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}o("wiki-common:widget/lib/jquery/jquery");var r=o("wiki-common:widget/component/userLogin/userLogin");t.exports={getUserMsg:function(){var o={};if("object"===e(arguments[0])){if(o=arguments[0],"function"!=typeof arguments[1])throw new Error('[userMsg Exception]: Invalid argument "callback".');var n=arguments[1]}else{if("function"!=typeof arguments[0])throw new Error('[userMsg Exception]: Invalid argument "callback".');n=arguments[0]}o.userInfo?n(null,o.userInfo.msgStatus):r.checkIfLogin({ifMsg:!0,onUnlogin:function(){return!1},onLogin:function(o){n(null,o.msgStatus)}})}}});